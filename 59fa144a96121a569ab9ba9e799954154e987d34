{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "c5cefb7e_e1f8ffd7",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "Overall, I reviewed this, and while I left a ton of comments, I\u0027m not convinced the design doc process is the right one for something like this.  I suspect that a design doc approval alone won\u0027t be enough to allow or disallow cloudbuild into the project, and its inclusion into openbmc-build-scripts is going to depend heavily on:\n1. How invasive the code changes it needs to make are.\n2. If the maintainers are willing to maintain it (and if not, if he\u0027s willing to let someone else maintain a portion of the build scripts that contain gcb).\n3. If the measured impacts to the obvious performance metrics (build time, SLA ect) are compelling enough to be worth the cost of the switch.\n4. If the \"Open\" part of openbmc can be maintained, while still allowing gcb support.\n\nAs an experiment, and line of engineering, this sounds very interesting, and something that\u0027s worth pursuing.  I don\u0027t think any of the maintainers can answer any of the above questions without seeing a series of patchsets, so my recommendation would be to start working.  Try to determine the refactorings and cleanups that need to happen that are irrelevant to enabling cloudbuild, and get those pushed first in your series, then get a basic prototype working, and we can evaluate the above from there.\n\n\nOverall, I think having more options for heterogeneity in build-server use is a good thing, not bad, and we should encourage it to the point that the complexity and maintainability will allow it.\n\nOne thing that isn\u0027t made clear in this design doc, but should be;  At this point Google has no plans that I\u0027m aware of for removing the non-gcb Jenkins CI resources that we currently donate to the project.  If gcb turns out to be a compelling option for any of the important metrics, there\u0027s an obvious path for us to convert how we donate to the project in the form of gcb resources instead of direct compute, but that will be a much bigger discussion, and has to encompass the best needs for the project.\n\n\nOverall, good stuff, lets see some good results.",
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d7d62725_a7d30dce",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1000682
      },
      "writtenOn": "2022-02-21T06:10:56Z",
      "side": 1,
      "message": "Hello Ed, thanks a lot for your detailed review. I would like Simon to answer most of your questions. \n\nI can provide some high level context: this is a 3-month intern project, and what is scoped is providing an alternative CI for \"on demand BMC releases\" only. The main target users for Google are Google\u0027s vendors. It\u0027s unlikely we will replace Jenkins in this time period. Instead, if we can finish the GCB configuration, get an E2E workflow demoed, push PRs to openbmc-build-scripts, and get them reviewed at the end of the internship, that\u0027s a solid start of the upstream GCB story, and it also fulfills our internal use cases. Google team and vendors will maintain the contributed codes.",
      "parentUuid": "c5cefb7e_e1f8ffd7",
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "88f788a7_3fbd495c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 11
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T17:43:59Z",
      "side": 1,
      "message": "\u003e The main target users for Google are Google\u0027s vendors. \n\nThen this doesn\u0027t really need an upstream design doc if we\u0027re not planning on doing this work upstream or reporting status back to upstream.\n\nLike I said, it seems a bit awkward to be dealing with an upstream design doc, especially so given the scope that you just laid out.  This is a super interesting line of research, and we should keep looking into it, but I think discord is probably a better forum for talking about individual changes, given that nobody on this doc is going to be able to approve that level of scope, so I would get on the #infrastruture channel, and start sending PRs for the things you need to do, and you can talk with the CI maintainers there when individual things come up that you\u0027d like to refactor in openbmc-build-scripts.  I suspect the abstraction of the separation is going to be important in those discussions.\n\n\n\u003e push PRs to openbmc-build-scripts, and get them reviewed at the end of the internship,\n\nI\u0027m sure you know this, but it\u0027s worth reiterating, don\u0027t push all your reviews at the end of the internship.  Make incremental progress over time in a series of patchsets submitted as you work, keeping the maintainers in the loop.  That will get you the best result.",
      "parentUuid": "d7d62725_a7d30dce",
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "24ac209d_67ef19f0",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 19,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "Nit, try to avoid using possessive adjectives like this.  Just call it OpenBMC;  Whether it\u0027s ours, yours, or mine is immaterial.",
      "range": {
        "startLine": 19,
        "startChar": 30,
        "endLine": 19,
        "endChar": 34
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7080ae0a_a1e19d92",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 23,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "Please follow the Openbmc template for this stuff, which should go in the background and references section.  Also, I realize that these are mostly googlable, but please add some crosslinks.\n\nhttps://github.com/openbmc/docs/blob/master/designs/design-template.md",
      "range": {
        "startLine": 12,
        "startChar": 0,
        "endLine": 23,
        "endChar": 0
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8b47b40a_ab5ac406",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 29,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "Lets add some more detail here.  \"scaling\" and \"availability\" have a lot of different definitions, so lets be crystal clear about what we\u0027re hoping to solve here.",
      "range": {
        "startLine": 28,
        "startChar": 65,
        "endLine": 29,
        "endChar": 69
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3a392e0b_81c72f6e",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 31,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "In terms of defintions, this is not part of the problem description.  This second paragraph is jumping directly to \"gcp is great because\".  Lets move the \"gcp is great\" stuff to the proposed design section.",
      "range": {
        "startLine": 31,
        "startChar": 0,
        "endLine": 31,
        "endChar": 63
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e67c9161_1a149f0e",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 71,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "For which builds?  There\u0027s a dozen or so build types specified.  Lets focus on the most common build types (repository and full build) and call out our targets by name.",
      "range": {
        "startLine": 71,
        "startChar": 0,
        "endLine": 71,
        "endChar": 26
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9f55c385_8ddf3ae4",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 72,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "This should not be a requirement.  The user should not get to select their build type.  Either sstate-cache works as designed, automatically, and this setting isn\u0027t required, or it doesn\u0027t and this setting would be set by the administrator.\n\nIf user \u003d\u003d administrator, lets be precise about that.",
      "range": {
        "startLine": 72,
        "startChar": 0,
        "endLine": 72,
        "endChar": 69
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "22c966db_8d641a48",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 73,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "This needs some more details on what this requirement means.  I think what we\u0027re really getting at here is that GCB should scale up and down based on the needs of the project with a reasonable level of ease.",
      "range": {
        "startLine": 73,
        "startChar": 0,
        "endLine": 73,
        "endChar": 75
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "eab0df49_e546c124",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 74,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "Same as above, using \"our own\" doesn\u0027t convey whos the owner, which we should be explicit about.  Is it google? openbmc (ie linux foundation)?\n\n\nAlso, this as written isn\u0027t a requirement.  It\u0027s part of the design.",
      "range": {
        "startLine": 74,
        "startChar": 8,
        "endLine": 74,
        "endChar": 15
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d6b0bdcf_5ac177c3",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 76,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "Some other important requirements:\n1. Builds should not rely on non-public components of the gcb infrastructure.\n2. Builds should be capable of completely replacing jenkins, and support all build types.\n3. Builds should be capable of \"garbage collecting\" with jenkins-equivalent or better rules for which builds to keep, and which builds to remove.\n4. Builds should be able to operate without administrator gerrit credentials, and when running without them, should avoid actions that require credentials (ie, setting build verify flags, ect).\n5. Artifacts from the build system are made available the public through appropriate linking\n6. System must be capable of setting the Verified status on gerrit patches.\n7. System should be maintainable, and should be the minimal set of diffs against existing openbmc to attain the design goals.  This is a super fuzzy requirement, but I suspect for something like this to be viable, it can\u0027t be reinventing and bifurcating all the existing capabilities we have.",
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8723fcd5_b9504587",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 80,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "This is great that you have milestones, but this isn\u0027t really what a design section is about.  Design should cover HOW you\u0027re planning on doing it, although, based on my reading, can probably be pretty minimal, because 90% of it is going to be \"use gcb to execute build jobs\", it\u0027s not clear there\u0027s a lot to design at this level.",
      "range": {
        "startLine": 80,
        "startChar": 0,
        "endLine": 80,
        "endChar": 46
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "15e8df3c_4e8590b3",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 82,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "Nit, the python version is unimportant at this level of document.  If the implementation requires python 3.2, that\u0027s probably workable, and isn\u0027t a core piece of the design itself. yes, please use the latest python version, it\u0027s just not important.",
      "range": {
        "startLine": 82,
        "startChar": 32,
        "endLine": 82,
        "endChar": 43
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ca22e287_6f431a35",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 84,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "What does this mean?  At OpenBMC project level, we don\u0027t have vendors;  Maybe this is a missing requirement around being able to use this on non-upstream repositories?",
      "range": {
        "startLine": 83,
        "startChar": 0,
        "endLine": 84,
        "endChar": 40
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9697c733_75c559de",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 87,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "\"should\" type vernacular implies this is also a requirement, not a design, and should go in the requirements section.",
      "range": {
        "startLine": 85,
        "startChar": 0,
        "endLine": 87,
        "endChar": 18
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7dd1a31c_91c45c8b",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 88,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "while this is good, I suspect there aren\u0027t great mocks for calling GCP resources, so I would classify this as a nice to have.",
      "range": {
        "startLine": 88,
        "startChar": 5,
        "endLine": 88,
        "endChar": 21
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aa1d0c04_89de93eb",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 90,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "Nit, this is OpenBMC, and we should follow its rules (which admittedly, I\u0027m pretty sure are a subset of the Google python style guide).",
      "range": {
        "startLine": 90,
        "startChar": 53,
        "endLine": 90,
        "endChar": 59
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5eeff447_c04d3e3d",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 92,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "What does this mean?",
      "range": {
        "startLine": 91,
        "startChar": 5,
        "endLine": 92,
        "endChar": 21
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "48711812_a6ba27c8",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 102,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "What does \"branch support\" mean?",
      "range": {
        "startLine": 102,
        "startChar": 9,
        "endLine": 102,
        "endChar": 10
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6961f1f3_55c6e340",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 104,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "If our goal is to push this to upstream, this seems like a non-starter for a public project.  Maybe the visibility is configurable, but anything we ran for the main project would need to be public.",
      "range": {
        "startLine": 104,
        "startChar": 34,
        "endLine": 104,
        "endChar": 38
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9358c8c5_c7674ab1",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 111,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "This would be a great piece in your design section.  The \"impacts\" section is \"here\u0027s the things that are going to be potential problems\"",
      "range": {
        "startLine": 108,
        "startChar": 0,
        "endLine": 111,
        "endChar": 55
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4cdd5987_d0efde9c",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 115,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "Upgrade implies a complete replacement, which I don\u0027t think is a goal here?\n\n\nOne missing impact is that there will be two code paths to maintain and test.  You should mention that, as well as ways you plan to mitigate that impact to the project.",
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1eeeacf7_2caf2ae7",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 121,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "Why didn\u0027t you pick these?  More details.",
      "range": {
        "startLine": 117,
        "startChar": 0,
        "endLine": 121,
        "endChar": 57
      },
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "85011420_ed7581fb",
        "filename": "designs/openbmc-ci-on-gcb.md",
        "patchSetId": 11
      },
      "lineNbr": 127,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2022-02-21T04:51:57Z",
      "side": 1,
      "message": "Performance tests?  Tests to ensure that it generates the same binaries as before?  Tests to ensure that CI failures are caught?  Tests to ensure gerrit integration is working?",
      "revId": "59fa144a96121a569ab9ba9e799954154e987d34",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}