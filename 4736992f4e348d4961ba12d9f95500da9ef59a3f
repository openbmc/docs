{
  "comments": [
    {
      "key": {
        "uuid": "bfb561af_cbecb360",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-07-01T12:36:19Z",
      "side": 1,
      "message": "Thanks for adding this.\n\nBut why?  Guard records are just a list of desires.  There is the possibility that any of them, including non-manual ones, might not be applied on the next reboot.  So why restrict a user from creating one unless the system is powered off?",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6e961bf2_d9302c47",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000427
      },
      "writtenOn": "2021-07-03T07:15:17Z",
      "side": 1,
      "message": "If a user voluntarily trying to guard hardware against booting then, he may think that the guard action (which is intended to do by a user) happened successfully but on few platforms, the guarded hardware record will be used in the next reboot right? \n\nIn a non-manual use case, the system may try to reboot based on an error but, for a manual use case, someone needs to indicate that your manual guard action won\u0027t happen if your system in a certain state right?",
      "parentUuid": "bfb561af_cbecb360",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3611e621_7c94321a",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-07-06T18:50:37Z",
      "side": 1,
      "message": "\u003e If a user voluntarily trying to guard hardware against booting then, he may think that the guard action (which is intended to do by a user) happened successfully but on few platforms, the guarded hardware record will be used in the next reboot right? \n\nI did not understand what you wrote here.",
      "parentUuid": "6e961bf2_d9302c47",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "2dededcd_00bf49e5",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000427
      },
      "writtenOn": "2021-07-07T04:58:07Z",
      "side": 1,
      "message": "Sorry, What I meant is, If a user tried to guard manually while the system is running or in the booting time, the guarded hardware won\u0027t be applied to isolate and it will be isolated in the next boot right?",
      "parentUuid": "3611e621_7c94321a",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "109c3589_6afb3bc8",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-07-07T12:05:13Z",
      "side": 1,
      "message": "\u003e If a user tried to guard manually while the system is running or in the booting time, the guarded hardware won\u0027t be applied to isolate and it will be isolated in the next boot right?\n\nI suppose it depends on the hardware and the system implementation, but likely, yes.\n\nHow is that different from an automatic guard though?  Similarly, they won\u0027t be applied until the next boot if that is all the system is capable of.\n\nConversely, if a manual guard is applied when the system powered off, there is also no guarantee that the manual guard will do anything, right?  On the next boot, the system calculates if the guard is able to be satisfied and if not it ignores it.\n\nSo I don\u0027t understand what is special about the system being powered on that we cannot allow guard records to be created [manually] in that state.  In no case does the user have certainty that the records will be acted upon.",
      "parentUuid": "2dededcd_00bf49e5",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bc3e8363_36bd3b3f",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000427
      },
      "writtenOn": "2021-07-07T12:44:23Z",
      "side": 1,
      "message": "\u003e How is that different from an automatic guard though?  Similarly, they won\u0027t be applied until the next boot if that is all the system is capable of.\n\nI think, based on the severity of the guard record, the system can request to reboot right? If so, then the available guard records will be applied right?\n\n\u003e Conversely, if a manual guard is applied when the system powered off, there is also no guarantee that the manual guard will do anything, right?  On the next boot, the system calculates if the guard is able to be satisfied and if not it ignores it.\n\nSorry, What you mean by \"applied\"? \"Created the guard record\" or \"System is processed the guarded record\" (I don\u0027t think you will refer to this since the isolation will happen in the next boot, if not correct me)?\n\nIf \"Created the guard record\" means, a user may need to know whether the guarded record (which is created by him) is isolated or not right? If so, How he knows when the isolation will happen for the guard record (which is created by him)? \n\nOR In general, the isolation for created guard record will happen only in the next boot so, the user should aware of that?",
      "parentUuid": "109c3589_6afb3bc8",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "05018ac5_3721d9f4",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-07-07T13:32:44Z",
      "side": 1,
      "message": "\u003e I think, based on the severity of the guard record, the system can request to reboot right? If so, then the available guard records will be applied right?\n\nMy recollection is that guard records do not directly trigger a reboot.  The severe event (usually a \"system checkstop\") brings down the system not the act of creating a guard record.\n\nBut, even if you were correct in that there are some guard records which as a side-effect trigger a reboot, that doesn\u0027t change my point.  Most automatic guard records are not applied immediately.\n\n\u003e Sorry, What you mean by \"applied\"? \"Created the guard record\" \n\nI used the wrong wording with \u0027applied\u0027 in this context.  \u0027Created\u0027 was what I meant.\n\n\u003e If \"Created the guard record\" means, a user may need to know whether the guarded record (which is created by him) is isolated or not right? If so, How he knows when the isolation will happen for the guard record (which is created by him)? \n\u003e OR In general, the isolation for created guard record will happen only in the next boot so, the user should aware of that?\n\nIt is my understanding that hardware is not isolated immediately and cannot be known if it will be isolated immediately.  The calculation of how to apply guard records to the system is in Hostboot (if I remember correctly), so the BMC cannot perform this calculation completely on its own.\n\nEven if the BMC could perform this calculation, the answer might change by the time the system reboots as additional automatic guard records could have been created which change the calculation.\n\n[The \"calculation\" in this context is the minimum hardware required to make a viable system.]",
      "parentUuid": "bc3e8363_36bd3b3f",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6eaa7dc4_981ff06d",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000427
      },
      "writtenOn": "2021-07-08T05:48:49Z",
      "side": 1,
      "message": "Thanks for asking the question \"Why only restrict the manual guard\". I was wrong on this statement\n\nI went and dig further, then got to know that \"not only manual guard case\" and also non-manual cases can be possible. \n\nI think the create dbus interface (Thanks to Patrick for the suggestion) can have \"NotAllowed\" (The requested hardware cannot be guarded on this system) and \"Unavailable\" (The requested hardware cannot currently be guarded on this system) error and the implementation can decide which one need to use based on the system use case.\n\nIf this is ok means, I can update the design document accordingly.",
      "parentUuid": "05018ac5_3721d9f4",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "438d3ec7_53e34913",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000086
      },
      "writtenOn": "2021-07-08T09:37:43Z",
      "side": 1,
      "message": "Patrick is correct, Creating guard records never creates reboot , it is based on the errorlog and system policy based on type of errors terminates the systems . and based on policy it can trigger reboot some cases.",
      "parentUuid": "6eaa7dc4_981ff06d",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6775a1f3_98345e6c",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-07-08T10:48:05Z",
      "side": 1,
      "message": "\u003e I think the create dbus interface (Thanks to Patrick for the suggestion) can have \"NotAllowed\" (The requested hardware cannot be guarded on this system) and \"Unavailable\" (The requested hardware cannot currently be guarded on this system) error and the implementation can decide which one need to use based on the system use case.\n\nI am ok with this.  I just don\u0027t think that \"Unavailable\" should be the default response in the cases where the system is powered on, in any implementation.\n\nEd brought up some concerns about how this would work in Redfish and made some suggestion of Redfish tasks being used to request creation of a guard record and the task would complete when the guard record took effect (or was indicated that it could not take effect).  It seems like using \"Unavailable\" would make an implementation rather difficult because the Redfish code would have to, effectively, poll on the Create interface until it became not-Unavailable.\n\n(I\u0027m not 100% certain on the details here w.r.t. Redfish tasks, so please go to Ed for more details.)",
      "parentUuid": "438d3ec7_53e34913",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "9bb0d9e5_bceecff4",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000427
      },
      "writtenOn": "2021-07-08T11:28:53Z",
      "side": 1,
      "message": "\u003e I am ok with this.  I just don\u0027t think that \"Unavailable\" should be the default response in the cases where the system is powered on, in any implementation.\n\nOk Thanks, I will update the design document and dbus interfaces.\n\n\u003e Redfish tasks being used to request creation of a guard record and the task would complete when the guard record took effect (or was indicated that it could not take effect).  It seems like using \"Unavailable\" would make an implementation rather difficult because the Redfish code would have to, effectively, poll on the Create interface until it became not-Unavailable.\n\u003e (I\u0027m not 100% certain on the details here w.r.t. Redfish tasks, so please go to Ed for more details.)\n\nOK, I wonder how the Redfish task will work or use poll - since manual guard record creation won\u0027t take any action immediately (it may be vary from another system point of view) until the next boot of host (if the record is for host owned device) - how long it can in a poll or any timeout.\n\nI am not an expert in Redfish - My first implementation in redfish is guard :) - Thanks for your time and information on this. Gathered a lot of information from you :).  I will check with Ed on this,",
      "parentUuid": "6775a1f3_98345e6c",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "106223e6_5a6d0614",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-07-08T11:48:17Z",
      "side": 1,
      "message": "\u003e OK, I wonder how the Redfish task will work or use poll - since manual guard record creation won\u0027t take any action immediately\n\nI suspect the Redfish interface would desire to call Create to create the guard record immediately and then monitor the Functional signal for the guard record to be applied.  Only when that signal occurs would the task be considered completed.\n\nBut, I\u0027m sure Ed has different thoughts too. ;)",
      "parentUuid": "9bb0d9e5_bceecff4",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "35d70753_c40a2213",
        "filename": "designs/guard-on-bmc.md",
        "patchSetId": 1
      },
      "lineNbr": 138,
      "author": {
        "id": 1000427
      },
      "writtenOn": "2021-07-08T16:06:07Z",
      "side": 1,
      "message": "\u003e then monitor the Functional signal for the guard record to be applied.\nYes we can watch for that Functional signal since PLDM (any other host interface) must update the Functional property based on the hardware health but, I wonder about the time since somehow (or someone) need to reboot the host to take the action for manual guard record or some record may be ignored (based on some calculation)\n\nI am seeing two options Redfish tasks and Redfish Events - I will dig further and will have word with Ed on this, also I will update you as well.",
      "parentUuid": "106223e6_5a6d0614",
      "range": {
        "startLine": 136,
        "startChar": 0,
        "endLine": 138,
        "endChar": 31
      },
      "revId": "4736992f4e348d4961ba12d9f95500da9ef59a3f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    }
  ]
}