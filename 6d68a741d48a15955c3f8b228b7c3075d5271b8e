{
  "comments": [
    {
      "key": {
        "uuid": "cf5fe88b_2640a47a",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 98,
      "author": {
        "id": 1000021
      },
      "writtenOn": "2021-07-28T19:33:38Z",
      "side": 1,
      "message": "How is this used differently than the request to power on below?\nThis may need input from the hardware team.",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a480a455_79af3e79",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 98,
      "author": {
        "id": 1000318
      },
      "writtenOn": "2021-07-28T20:20:26Z",
      "side": 1,
      "message": "They are basically the same on these systems.  Historically, the sequencer hw power on request would turn on all the voltages, then afterwards fw would use a \"software_pgood\" gpio to take all the chips out of reset at the same time.  However, the power sequencer hw used on these systems do both of those things, so the gpios basically both do the same thing.\n\nIMHO the gpio isn\u0027t a status... it\u0027s on output, not an input.",
      "parentUuid": "cf5fe88b_2640a47a",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "c766b042_27a5bae7",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 98,
      "author": {
        "id": 1000318
      },
      "writtenOn": "2021-07-28T20:21:38Z",
      "side": 1,
      "message": "it\u0027s AN output, not an input.",
      "parentUuid": "a480a455_79af3e79",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d1fc2d22_9e95f79b",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 98,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2021-07-28T22:24:11Z",
      "side": 1,
      "message": "Why does `status-` need to imply a direction? How would you name GPIOs to differentiate input vs output status lines?",
      "parentUuid": "c766b042_27a5bae7",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "204477d5_01d98706",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 98,
      "author": {
        "id": 1000318
      },
      "writtenOn": "2021-07-29T03:28:53Z",
      "side": 1,
      "message": "It\u0027s not a status any more than \"power-chassis\" is a status.  Why isn\u0027t that \"status-power-chassis\" then? That gpio does the same thing...  But honestly if we continue to spend a week+ going back and forth over something as simple as a gpio name, we\u0027ll never get systems out the door, so we can call it whatever people want, lets just get it done and move on.",
      "parentUuid": "d1fc2d22_9e95f79b",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "6e4f6ff6_2f6db8bc",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 98,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2021-07-29T04:28:01Z",
      "side": 1,
      "message": "Sort-of working backwards here, because I think it\u0027s easier to respond that way.\n\n\u003e But honestly if we continue to spend a week+ going back and forth ... we\u0027ll never get systems out the door\n\nThe open source project cares about what\u0027s right for the project, not when you need to deliver systems. Leverage it as you see fit. The trade-off is that more downstream code means fewer shared benefits and more maintenance.\n\nI appreciate that we\u0027re trying to do the right thing upstream here.\n\n\u003e going back and forth over something as simple as a gpio name\n\nThat\u0027s the thing, it\u0027s not simple, because the name forms a contract between the kernel and userspace. Once it\u0027s decided, changing it can lead to compatibility headaches. Using net names for specific systems makes writing common code harder. So we\u0027re putting effort into this document to minimise the compatibility headaches and maximise the amount of code reuse in the system.\n\nIn my opinion it\u0027s only a simple problem if you care about the system you\u0027re trying to deliver right now to the exclusion of all else. I\u0027m reviewing this as a contribution to the open source project, not to a specific system delivery deadline.\n\nMaybe the outcome is that it\u0027s not possible to use a common name for these GPIOs. But at least we will have had the discussion and it will be documented here.\n\n\u003e It\u0027s not a status any more than \"power-chassis\" is a status\n\nI feel this is only true if you eliminate intent. But isn\u0027t intent the whole point here? I was using \u0027power\u0027 in the verb sense (I didn\u0027t explicitly state this though). You set the GPIO when you want to direct the remote end to change state (1 or more effects). Contrast this to a `status` GPIO, which isn\u0027t trying to drive any particular behaviour, just alert anything that is listening to a particular state (0 or more effects).\n\nMy understanding of SOFTWARE_PGOOD as a net was that we set it when the BMC was ready (0 or more effects), and we set BMC_POWER_UP when we wanted the host to boot (1 or more effects). This is what drove my use of status for the former and not for the latter. If this isn\u0027t accurate then we can reconsider.",
      "parentUuid": "204477d5_01d98706",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "b6b17dbf_86eefa39",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 98,
      "author": {
        "id": 1000021
      },
      "writtenOn": "2021-07-29T04:41:45Z",
      "side": 1,
      "message": "I think it was more a backup safety net \"software says power might be good, so its vote is release reset\".  It has nothing to do with the readiness of the BMC to perform some action.\n\nPrevous products used this to say \"ok the boot has progressed far enough that hardware can control the downstream device resets\".  The fact that we could set it at time 0 means we got the rest of the hardware right.  (I think this can be observed in POWER8 systems).\n\nThis is why I suggested a pass though the hardware design team for the name.",
      "parentUuid": "6e4f6ff6_2f6db8bc",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ede86e18_a5c7cd45",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 98,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-07-29T11:17:45Z",
      "side": 1,
      "message": "I think the big lessons learned here is that we need much more than a word (first patch set) and sometimes more than a single sentence (second patch set) so that we can all get on the same page as to what is being proposed.\n\nThis GPIO naming space isn\u0027t very mature yet so there is going to be some back and forth as we try to figure out the general patterns and get something that is workable for the future.  When a pin is in these \"special sections\", it is better to just do a brain-dump of everything you know about it to save some of this back and forth.  This gives others and opportunity to think about the \"big picture\" on the class of pins and see if it warrants a first-class section of its own.\n\nAs Andrew said, these are important because they frame a contract between kernel space (device tree) and userspace.  Once we commit to one it is very hard to change.  At a minimum we have to send the patch out to a community we don\u0027t have as much control over (kernel) and maintain dual-support in the userspace code for a time.  Generally speaking, the external kernel team frowns very heavily on changing the UAPI.",
      "parentUuid": "b6b17dbf_86eefa39",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "036324c7_39165481",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 99,
      "author": {
        "id": 1000021
      },
      "writtenOn": "2021-07-29T05:25:56Z",
      "side": 1,
      "message": "Commenting here to break up the discussion since I think it deserves a separate thread.\n\nI don\u0027t think we should adopt status as group of signals because all inputs to the bmc are status, so it becomes a low usefullness term.\n\nThis is in addition to but seperate from the \"status might be an output from the bmc\" argument.",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3e5b3543_d5f18acf",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 99,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-07-29T11:17:45Z",
      "side": 1,
      "message": "üëç",
      "parentUuid": "036324c7_39165481",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "ae97a803_5bf9fa7c",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 101,
      "author": {
        "id": 1000021
      },
      "writtenOn": "2021-07-28T19:33:38Z",
      "side": 1,
      "message": "This is an output but seems to be missing the action.\n\n\nAs I understand it\u0027s both to request power be turned on and to request it be turned off for shutdown by setting it low.  \n\n(It\u0027s different than the PC power supply button protocol.)",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "42625eff_d070a724",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 2
      },
      "lineNbr": 106,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-07-29T11:17:45Z",
      "side": 1,
      "message": "(New comment line to again break up discussion)\n\nWhere I\u0027d like to see this patch set go:\n\n1. Andrew Jeffery already has a patch set Iab031eaa2275e8c51881c0636e5925c077ff5caa adding a \u0027bmc-status-ready\u0027 (name to change) which is suppose to be an indication that network services are up.\n1a. I would like a new section added for \"states of the BMC it wants to communicate via GPIOs\" added for the proposed \u0027bmc-status-ready\u0027 (by Andrew) and \u0027status-bmc-ready\u0027 (by Jim).\n1b. As you see they\u0027ve both picked a very similar name for states that are vastly different.  So we need some more specificity than \"ready\".  My gut feeling of the bike shed color is \"bmc-status-net-services\" and \"bmc-status-host-boot-\u003cn\u003e\", but I feel like I don\u0027t know enough about Jim\u0027s pin purpose.\n1c. Andrew and Jim both work at the same company.  Please work together to create a new commit that codifies a \u0027bmc-status\u0027 section.\n\n2. I can\u0027t tell which of these pins are input and which are output from the current words.\n2a. As Milton also said, I don\u0027t like \u0027status-\u0027 on input pins because it is fairly meaningless since all input pins are a \"status\" from elsewhere.\n\n3. \u0027power-chassis\u0027 sounds like a variant of \u0027status-bmc-ready\u0027 from the rwording and the discussion.  ie. \"The BMC has investigated hardware and reached a status of its own such that the chassis power-on sequence may begin.\"  With that in mind, I can\u0027t really tell the difference between this and \u0027status-bmc-ready\u0027 but I believe you have one.  We need to either come up with wording that articulates the difference better or allow multiple pins in from my proposed \"bmc-status-host-boot-\u003cn\u003e\".\n3a. The \u003cn\u003e in my original host-boot-\u003cn\u003e was meant to allow booting of multiple hosts independently.  Maybe we need something like \u0027host-\u003cn\u003e-boot-\u003cm\u003e\u0027 to handle multi-host designs AND multiple-but-similar-purposed indicators.\n\n4. \u0027status-chassis-power\u0027 I assume is an input pin.\n4a. Ben Tyner also has another commit (I4fe71dd034a08d58060489ddc0a6ac3a60f20506) where he is trying to add some VRM fault pins.\n4b. I\u0027d like a new section to propose how we handle pgood/pfault pins.  (My opinion is that, at a high level, pgood vs power fault pins are essentially the same thing but with opposite polarity).\n4c. Please have Jim and Ben (who also work at the same company) come up with a combined commit to work on this section.\n\n5. My expectation for both of these new sections is that they are not a simple \"list of valid pins\" but that they have some general principles we can apply as new pins come to light AND clear/complete/concise documentation of the *specific* pins being used by these immediate designs.",
      "revId": "6d68a741d48a15955c3f8b228b7c3075d5271b8e",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    }
  ]
}