{
  "comments": [
    {
      "key": {
        "uuid": "45d88f60_18aae919",
        "filename": "tof/proposals/otp-4.md",
        "patchSetId": 1
      },
      "lineNbr": 24,
      "author": {
        "id": 1000044
      },
      "writtenOn": "2021-10-12T05:28:30Z",
      "side": 1,
      "message": "Agreed to enforce meson for new repos.",
      "revId": "df11c7f67de18c9e616d53d96c8db793027be32c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ddcc6d33_e27fcc5c",
        "filename": "tof/proposals/otp-4.md",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1000044
      },
      "writtenOn": "2021-10-12T05:28:30Z",
      "side": 1,
      "message": "Some repos are using C and autotools are used, what is the benefit to enforce such repos to use meson? The \"Rationale\" is mostly about C++20.",
      "revId": "df11c7f67de18c9e616d53d96c8db793027be32c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "3732a351_ad3c4afa",
        "filename": "tof/proposals/otp-4.md",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-10-12T14:18:59Z",
      "side": 1,
      "message": "Lines 43-44 and 51-53 are still very relevant to C repositories.",
      "parentUuid": "ddcc6d33_e27fcc5c",
      "revId": "df11c7f67de18c9e616d53d96c8db793027be32c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e6fda9c5_3848946a",
        "filename": "tof/proposals/otp-4.md",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1000044
      },
      "writtenOn": "2021-10-13T03:11:44Z",
      "side": 1,
      "message": "OK, but that\u0027s about why meson is easier (and probably better) choice for new repos.\n\nMy point is, if a repo not using meson is going to be deleted, it gives some bad expression that openbmc forces the build tools.\nAs an open community, deleting a repo seems \"too much\".\n\nHow about making it failure to pass CI so that new changes are enforced to use meson, but if an existing repo is not updated, it could be kept?",
      "parentUuid": "3732a351_ad3c4afa",
      "revId": "df11c7f67de18c9e616d53d96c8db793027be32c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e117eaf4_0250c820",
        "filename": "tof/proposals/otp-4.md",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-10-13T11:50:02Z",
      "side": 1,
      "message": "\u003e OK, but that\u0027s about why meson is easier (and probably better) choice for new repos.\n\nMy view is that it is probably still a better choice for existing repos because they\u0027re likely not doing those things (ex. static analysis) if they are autotools based.  Thus they are not utilizing the current best practices in both the project and industry as a whole.\n\n\u003e As an open community, deleting a repo seems \"too much\".\n\nBut I\u0027m not suggesting deleting a repo.  I wrote that we would delete the _recipe_.  The code may still live in the individual repo and when they get it updated it can be reintegrated into the distribution, but until then it is kept out.\n\n\u003e How about making it failure to pass CI so that new changes are enforced to use meson, but if an existing repo is not updated, it could be kept?\n\nAll this does is likely push the work onto the first person attempting to do any kind of API refactoring.  If the maintainer and the users cannot be bothered to get it updated, I don\u0027t want to put an impediment onto someone else attempting to make sweeping improvements.  There is no reason that, for example, adding a [[nodiscard]] to a function we realize is often mistakenly ignored should requirement to rewrite a whole repo into meson in order to get it in.",
      "parentUuid": "e6fda9c5_3848946a",
      "revId": "df11c7f67de18c9e616d53d96c8db793027be32c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f3059fd3_7c51228d",
        "filename": "tof/proposals/otp-4.md",
        "patchSetId": 1
      },
      "lineNbr": 32,
      "author": {
        "id": 1000044
      },
      "writtenOn": "2021-10-14T02:07:33Z",
      "side": 1,
      "message": "\u003e But I\u0027m not suggesting deleting a repo.  I wrote that we would delete the _recipe_. \n\nOK, I missed the \"recipe\" part. Fair enough.\n\n\u003e All this does is likely push the work onto the first person attempting to do any kind of API refactoring.\n\nOK, that\u0027s not a good option.",
      "parentUuid": "e117eaf4_0250c820",
      "revId": "df11c7f67de18c9e616d53d96c8db793027be32c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "24a06b1a_65caabd9",
        "filename": "tof/proposals/otp-4.md",
        "patchSetId": 1
      },
      "lineNbr": 35,
      "author": {
        "id": 1000044
      },
      "writtenOn": "2021-10-12T05:28:30Z",
      "side": 1,
      "message": "As Ed indicated, it\u0027s not an easy and smooth way to convert to meson from cmake, gaps exist.\ncmake is modern and it support C++20 as well.\nThe \"Rationale\" about cmake is it lacks of tools to build outside of oe-sdk env. But one could either build and test it with openbmc-build-scripts, or some existing repos already has external_project defined to build in typical Linux system.",
      "revId": "df11c7f67de18c9e616d53d96c8db793027be32c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "258f592e_69aa744c",
        "filename": "tof/proposals/otp-4.md",
        "patchSetId": 1
      },
      "lineNbr": 35,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-10-12T14:18:59Z",
      "side": 1,
      "message": "Do you have instances of patterns we are using in cmake that are hard to replicate in meson?  I’ve done quite a bit of work on the autotools conversions already and tackled most of the “hard” repositories that are doing python code generation.  My feeling was that most of the cmake repositories were much more straight-forward.  I’ll certainly help out where needed if the conversions are especially difficult to align patterns between the two build systems.\n\nRe openbmc-build-scripts.  The time to build a meson repository with proper wrap files is in the order of 10s of seconds.  The time to build anything in openbmc-build-scripts, if you have the Docker images ready to go, is on the order of minutes.  If you don’t have the Docker images ready to go you’re looking at ~30 to build that.  This is a huge productivity hit in a normal code/compile/test development cycle.\n\nI thought I mentioned ExternalProject somewhere but it looks like I left it out of this doc.  I can add it here.  The issues I have with relying on ExternalProject are two-fold:\n* We’re duplicating a pattern that we already have better support for in Meson, but currently ExternalProject isn’t used everywhere and it isn’t used in consistently similar ways.\n* The specifications for ExternalProject are not easily identifiable and updatable with scripts, compared to wrap files.  Many of our current ExternalProject users chose to pin to a particular commit in the dependent project and in order to find and update them we’d have to write a CMake parser tool.  With wrapfiles they are separate and easily found with a `find -name` type invocation, which can be used to trivially update them all.  (ex. when nlohmann-json makes a new release how do we update all the users?)",
      "parentUuid": "24a06b1a_65caabd9",
      "revId": "df11c7f67de18c9e616d53d96c8db793027be32c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "f0468901_2a76f9f8",
        "filename": "tof/proposals/otp-4.md",
        "patchSetId": 1
      },
      "lineNbr": 35,
      "author": {
        "id": 1000044
      },
      "writtenOn": "2021-10-14T02:07:33Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "258f592e_69aa744c",
      "revId": "df11c7f67de18c9e616d53d96c8db793027be32c",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": false
    }
  ]
}