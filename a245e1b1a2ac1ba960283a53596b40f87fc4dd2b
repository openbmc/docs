{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "b40c8c03_8ab2b266",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1001198
      },
      "writtenOn": "2023-06-02T09:34:18Z",
      "side": 1,
      "message": "Hi all, I want to propose design document for Power Management application which follows chapter 6.6 of DCMI specification to monitor and control total power consumption.\nPlease help me to review this document.\n\nThanks",
      "revId": "a245e1b1a2ac1ba960283a53596b40f87fc4dd2b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "3e97866d_4bee9049",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 5
      },
      "lineNbr": 0,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2023-06-02T15:20:53Z",
      "side": 1,
      "message": "Adding Chris and Martha from IBM who I think own the design on the existing power management application.",
      "revId": "a245e1b1a2ac1ba960283a53596b40f87fc4dd2b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "12bc7bbe_56527bda",
        "filename": "designs/power-manager.md",
        "patchSetId": 5
      },
      "lineNbr": 11,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2023-06-02T15:20:53Z",
      "side": 1,
      "message": "0?",
      "range": {
        "startLine": 11,
        "startChar": 11,
        "endLine": 11,
        "endChar": 18
      },
      "revId": "a245e1b1a2ac1ba960283a53596b40f87fc4dd2b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ffa9d064_9bea5a50",
        "filename": "designs/power-manager.md",
        "patchSetId": 5
      },
      "lineNbr": 13,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2023-06-02T15:20:53Z",
      "side": 1,
      "message": "I thought IBM had something implemented for this?",
      "range": {
        "startLine": 11,
        "startChar": 0,
        "endLine": 13,
        "endChar": 43
      },
      "revId": "a245e1b1a2ac1ba960283a53596b40f87fc4dd2b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "cc324909_a11f6b60",
        "filename": "designs/power-manager.md",
        "patchSetId": 5
      },
      "lineNbr": 15,
      "author": {
        "id": 1000238
      },
      "writtenOn": "2023-06-02T16:42:09Z",
      "side": 1,
      "message": "The OCC (On Chip Controller) provides power monitoring and control.\nhttps://github.com/open-power/docs/tree/P10/occ\n\nThe OCC is always monitoring the power usage to ensure it is within the system power capacity.  If the system power usage goes over that limit for a period of time, the system will be moved to a safe mode (reduced power and performance).\nSafe mode is defined to allow the system to continue safe system operation without shutting the system off.\n\nThe openpower-occ-control app is responsible for communicating with the OCC and reporting the thermal and power sensor data.",
      "revId": "a245e1b1a2ac1ba960283a53596b40f87fc4dd2b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c6fd85ef_16f149ba",
        "filename": "designs/power-manager.md",
        "patchSetId": 5
      },
      "lineNbr": 35,
      "author": {
        "id": 1000238
      },
      "writtenOn": "2023-06-02T16:42:09Z",
      "side": 1,
      "message": "A user power cap can also be specified via GUI or Redfish.\nThe OCC will then create a PEL if the system exceeds that user specified power cap.\nThis is intended on being a power saving feature, not for system protection, so I don\u0027t think this would be a reason to power off a system.\n\nHere is the user power limit (PowerCap / PowerCapEnable properties): \n```# busctl introspect xyz.openbmc_project.Settings /xyz/openbmc_project/control/host0/power_cap\nNAME                                  TYPE      SIGNATURE RESULT/VALUE FLAGS\norg.freedesktop.DBus.Introspectable   interface -         -            -\n.Introspect                           method    -         s            -\norg.freedesktop.DBus.Peer             interface -         -            -\n.GetMachineId                         method    -         s            -\n.Ping                                 method    -         -            -\norg.freedesktop.DBus.Properties       interface -         -            -\n.Get                                  method    ss        v            -\n.GetAll                               method    s         a{sv}        -\n.Set                                  method    ssv       -            -\n.PropertiesChanged                    signal    sa{sv}as  -            -\nxyz.openbmc_project.Control.Power.Cap interface -         -            -\n.MaxPowerCapValue                     property  u         2777         emits-change writable\n.MinPowerCapValue                     property  u         1778         emits-change writable\n.MinSoftPowerCapValue                 property  u         556          emits-change writable\n.PowerCap                             property  u         1000         emits-change writable\n.PowerCapEnable                       property  b         false        emits-change writable```\nAnd via Redfish: /redfish/v1/Chassis/chassis/EnvironmentMetrics\n```    \"PowerLimitWatts\": {\n        \"AllowableMax\": 2777,\n        \"AllowableMin\": 1778,\n        \"ControlMode\": \"Disabled\",\n        \"SetPoint\": 1000\n    }```\n\nThe OCC is always monitoring the power to ensure it is within the system power limit. Again if consumption exceeds the system power limit (AllowableMax property), it is moved to safe mode to keep the hardware safe but still operational.",
      "revId": "a245e1b1a2ac1ba960283a53596b40f87fc4dd2b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "55fcc93d_b6e279e6",
        "filename": "designs/power-manager.md",
        "patchSetId": 5
      },
      "lineNbr": 98,
      "author": {
        "id": 1000238
      },
      "writtenOn": "2023-06-02T16:42:09Z",
      "side": 1,
      "message": "OCC provides a total power consumption via Redfish: /redfish/v1/Chassis/chassis/EnvironmentMetrics\n``` \"PowerWatts\": {\n   \"@odata.id\": \"/redfish/v1/Chassis/chassis/Sensors/total_power\",\n   \"DataSourceUri\": \"/redfish/v1/Chassis/chassis/Sensors/total_power\",\n   \"Reading\": 998.0\n }```",
      "revId": "a245e1b1a2ac1ba960283a53596b40f87fc4dd2b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bec7f2c4_566b2d45",
        "filename": "designs/power-manager.md",
        "patchSetId": 5
      },
      "lineNbr": 107,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2023-06-02T15:20:53Z",
      "side": 1,
      "message": "Do you have proposals on the dbus interfaces you\u0027d like to see?",
      "revId": "a245e1b1a2ac1ba960283a53596b40f87fc4dd2b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "886c7dcb_df072f3c",
        "filename": "designs/power-manager.md",
        "patchSetId": 5
      },
      "lineNbr": 186,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2023-06-02T15:20:53Z",
      "side": 1,
      "message": "It looks like the \"Organizational\" section was deleted or an old template was used when you wrote this.  That is pretty important in this case because it sounds like you\u0027re going to be requesting a new repository?",
      "revId": "a245e1b1a2ac1ba960283a53596b40f87fc4dd2b",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}