{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "bde06da4_4567829d",
        "filename": "designs/no-fru-device-hw-detect.md",
        "patchSetId": 7
      },
      "lineNbr": 51,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-10-05T00:33:01Z",
      "side": 1,
      "message": "I think the gist of one of Matt\u0027s comments was we\u0027re constructing a bit of a house of cards here, and I tend to agree. The chain of D-Bus services involved is starting to feel a little long. If you must use the u-boot environment, can you probe on the phosphor-u-boot-env-mgr representation of the data?\n\nHowever, I think the right direction might be in the direction of a reserved memory region as suggested by Milton below. A daemon for parsing the data straight out of the reserved memory and representing it on D-Bus gets you one less link in the D-Bus chain without abusing the u-boot environment.",
      "revId": "452cd8d94e1ca3ba83ddecc30fad04916aa6dc36",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "514b891b_6b4246c5",
        "filename": "designs/no-fru-device-hw-detect.md",
        "patchSetId": 7
      },
      "lineNbr": 97,
      "author": {
        "id": 1000021
      },
      "writtenOn": "2023-10-04T20:27:14Z",
      "side": 1,
      "message": "I don\u0027t know the lifetime of your method how you check if its up to date, but did you consider using a reserved memory region https://github.com/openbmc/linux/blob/dev-6.5/Documentation/devicetree/bindings/reserved-memory/memory-region.yaml or even a pstore file to hold the content instead of forcing it into the u-boot environment?  The environment is usually in a fixed location in flash and writing it every boot may cause a wear out concern.  Alternatively this would tie up some amount of RAM.  (If you have already considered how to check before rewriting the enviornment you can state so, but the only reason I see that you selected it was because the environment to dbus path already existed).\n\n(Yes, pstore is normally used for logging of events, traces, console messages, etch and so configuration could be considered off topic for that.  But I\u0027d also say the u-boot environment is too).",
      "revId": "452cd8d94e1ca3ba83ddecc30fad04916aa6dc36",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "208b389a_eb6cc385",
        "filename": "designs/no-fru-device-hw-detect.md",
        "patchSetId": 7
      },
      "lineNbr": 97,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-10-05T00:33:01Z",
      "side": 1,
      "message": "+1 for this line of investigation!",
      "parentUuid": "514b891b_6b4246c5",
      "revId": "452cd8d94e1ca3ba83ddecc30fad04916aa6dc36",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "34fdb99e_9530e1b7",
        "filename": "designs/no-fru-device-hw-detect.md",
        "patchSetId": 7
      },
      "lineNbr": 97,
      "author": {
        "id": 1001354
      },
      "writtenOn": "2023-10-10T19:56:13Z",
      "side": 1,
      "message": "I hadn\u0027t considered those things before, but will definitely investigate further. Thanks for the suggestions!",
      "parentUuid": "208b389a_eb6cc385",
      "revId": "452cd8d94e1ca3ba83ddecc30fad04916aa6dc36",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "05b9f32a_6848743e",
        "filename": "designs/no-fru-device-hw-detect.md",
        "patchSetId": 7
      },
      "lineNbr": 97,
      "author": {
        "id": 1001354
      },
      "writtenOn": "2023-10-17T19:33:08Z",
      "side": 1,
      "message": "How would folks feel about a daemon (likely hosted by Entity-Manager) that picks up data for D-Bus from /proc/device-tree/chosen? \n\nhttps://www.kernel.org/doc/Documentation/devicetree/bindings/chosen.txt\n\nIt turns out we\u0027re using \u0027chosen -\u003e d-bus\u0027 daemons in proof of concept code already, and I may have been confusing things in previous discussions about it by referring to reads from there as \u0027filesystem access\u0027 (which resulted in some of the pushback re: relying on the filesystem that lead to the focus on phosphor-uboot-env-mgr)\n\nAnd you are correct- we started looking into using into phosphor-uboot-env-mgr mostly because HPE is relying u-boot to parse data from u-Bootblock.\n\nThat HW ID data is being passed to u-boot via a location in RAM by u-BootBlock, which is retrieving the data we need from a secure element with no direct BMC access.\n\nIf there are no objections, I\u0027ll be working on updating documentation to discuss a potential \u0027chosen -\u003e d-bus\u0027 daemon instead of relying of phosphor-uboot-env-mgr.",
      "parentUuid": "34fdb99e_9530e1b7",
      "revId": "452cd8d94e1ca3ba83ddecc30fad04916aa6dc36",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6a531f8f_015cdc34",
        "filename": "designs/no-fru-device-hw-detect.md",
        "patchSetId": 7
      },
      "lineNbr": 97,
      "author": {
        "id": 1001354
      },
      "writtenOn": "2023-10-18T20:52:02Z",
      "side": 1,
      "message": "A new version of the HPE-specific process (which goes into details about things like HPE\u0027s secure element -\u003e u-BootBlock -\u003e u-Boot -\u003e D-Bus pipeline) has been uploaded @ https://gerrit.openbmc.org/c/openbmc/docs/+/66369\n\nThis new doc switches to relying on a daemon that reads from file handles in /proc/device-tree/chosen/ instead using d-bus calls through phosphor-uboot-env-mgr.\n\n\u003eThe chosen node does not represent a real device, but serves as a place\nfor passing data between firmware and the operating system, like boot\narguments\n\nIf there\u0027s pushback on using chosen/, we\u0027re we\u0027ll look at switching reserved memory regions.\n\nA new version of *this* doc should also be uploaded shortly with similar changes. I see this doc as being more for a discussion of a generally usable [channel] -\u003e D-Bus daemon without diving too deeply into HPE-specific details.",
      "parentUuid": "05b9f32a_6848743e",
      "revId": "452cd8d94e1ca3ba83ddecc30fad04916aa6dc36",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "ce025801_4097de41",
        "filename": "designs/no-fru-device-hw-detect.md",
        "patchSetId": 7
      },
      "lineNbr": 97,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-10-18T23:53:43Z",
      "side": 1,
      "message": "I\u0027ve responded on the other design doc. I think I\u0027ll hold off on re-reviewing this one until we\u0027ve got some of the details sorted out.",
      "parentUuid": "6a531f8f_015cdc34",
      "revId": "452cd8d94e1ca3ba83ddecc30fad04916aa6dc36",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1e18ae09_0d84f5df",
        "filename": "designs/no-fru-device-hw-detect.md",
        "patchSetId": 7
      },
      "lineNbr": 143,
      "author": {
        "id": 1000559
      },
      "writtenOn": "2023-10-04T17:54:53Z",
      "side": 1,
      "message": "where would this service gets defined?",
      "range": {
        "startLine": 140,
        "startChar": 0,
        "endLine": 143,
        "endChar": 0
      },
      "revId": "452cd8d94e1ca3ba83ddecc30fad04916aa6dc36",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "11df6bc9_4f60199c",
        "filename": "designs/no-fru-device-hw-detect.md",
        "patchSetId": 7
      },
      "lineNbr": 143,
      "author": {
        "id": 1001354
      },
      "writtenOn": "2023-10-10T19:56:13Z",
      "side": 1,
      "message": "I was thinking it would make sense to include it in Entity-Manager, but am planning to try posting on the OBMC mailing list for further discussion on where any \u0027new\u0027 HW -\u003e D-Bus daemons should live.",
      "parentUuid": "1e18ae09_0d84f5df",
      "range": {
        "startLine": 140,
        "startChar": 0,
        "endLine": 143,
        "endChar": 0
      },
      "revId": "452cd8d94e1ca3ba83ddecc30fad04916aa6dc36",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ],
  "submitRequirementResults": []
}