{
  "comments": [
    {
      "key": {
        "uuid": "82f6477d_7145b9a3",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 5
      },
      "lineNbr": 105,
      "author": {
        "id": 1000021
      },
      "writtenOn": "2021-11-05T16:02:14Z",
      "side": 1,
      "message": "Prior comment on host running is equally an indicator.\n\nTo expand on the watchdog both this and line 85 regulator-standby-faulted records prior status but perhaps both of these status should be exposed through the kernel watchdog API\n\nhttps://github.com/openbmc/linux/blob/781a66e81bbb9081e74d9ba0fcee095fefa1048e/include/uapi/linux/watchdog.h#L39\nhttps://github.com/openbmc/linux/blob/dev-5.15/Documentation/watchdog/watchdog-api.rst#environmental-monitoring\n\nAlso there was an interface defined to add watchdog cause to dbus, fwiw",
      "revId": "bc09818c1df0a8861e05910d3b66f9fcfdab32b3",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "d756e893_a449c0b7",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 5
      },
      "lineNbr": 105,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2021-11-08T00:55:18Z",
      "side": 1,
      "message": "Does the pinhole reset poke EXTRST on the BMC?\n\nSince my previous comment Patrick pointed out that EXTRST is recorded as a reset cause in the SCU (e.g. see SCU074[1] on page 443 in ast2600v09.pdf). We could expose that through appropriate kernel interfaces which would remove the need for this GPIO? Was the reset cause capability an oversight wrt the board design?\n\nI\u0027m okay if we still define the GPIO here, just trying to resolve whether it is in-fact redundant.",
      "parentUuid": "82f6477d_7145b9a3",
      "revId": "bc09818c1df0a8861e05910d3b66f9fcfdab32b3",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "e4158006_3de18345",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 5
      },
      "lineNbr": 105,
      "author": {
        "id": 1000004
      },
      "writtenOn": "2021-11-08T19:48:46Z",
      "side": 1,
      "message": "For our p10bmc system design, the pin hole reset was wired to report that it has occurred via this GPIO. It represents a full system reset triggered by pushing the pin hole reset. We can have a discussion with Emile internally on whether future systems could utilize this SCU. It seems like a better design point to have all of the reasons in one place (i.e. the SCU in the AST2600). One of Patrick\u0027s comments on a review about the code using this pin, is who gets priority (the sysfs watchdog reason interface or the GPIO) so there\u0027s definitely a certain amount of confusion that comes with having multiple ways to report why a reboot occurred. But at this point, it seems like we are where we are with p10bmc and this GPIO needing a name.",
      "parentUuid": "d756e893_a449c0b7",
      "revId": "bc09818c1df0a8861e05910d3b66f9fcfdab32b3",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "a8955fb5_4bf52f3e",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 5
      },
      "lineNbr": 105,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2021-11-08T21:36:21Z",
      "side": 1,
      "message": "One thing I’m still not sure we understand is what kind of reset this triggers. All BMC resets are already recorded in the SCU. When you say “full system reset” does that mean the BMC sees it as a POR?  ie, somehow standby power is dropped to the BMC?  That would be a bit surprising to me.",
      "parentUuid": "e4158006_3de18345",
      "revId": "bc09818c1df0a8861e05910d3b66f9fcfdab32b3",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    },
    {
      "key": {
        "uuid": "bf141791_cdad52d8",
        "filename": "designs/device-tree-gpio-naming.md",
        "patchSetId": 5
      },
      "lineNbr": 105,
      "author": {
        "id": 1000004
      },
      "writtenOn": "2021-11-08T22:01:22Z",
      "side": 1,
      "message": "From Emile:\n\n\u003e we reset all the ASICs in the box. including ebmc, emmc, etc. except for not removing standby power. \n\nI think a key piece here is we want to be able to differentiate between a watchdog/error type reboot and a user manually triggering a PHR, hence the need for this GPIO. Per AndrewJ:\n\n\u003e EXTRST can be hit in other less intrusive ways, such as the host detecting the BMC is unresponsive. Given that\u0027s different from a pinhole reset, the disambiguation via the GPIO makes sense\n\nSo on further discussion with Patrick, this GPIO is really a supplement to EXTRST. There are a lot of things that can trigger a EXTRST and this GPIO provides additional details on what it was. Given that, lets change the GPIO pattern to reset-cause-*   (?)",
      "parentUuid": "a8955fb5_4bf52f3e",
      "revId": "bc09818c1df0a8861e05910d3b66f9fcfdab32b3",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4",
      "unresolved": true
    }
  ]
}