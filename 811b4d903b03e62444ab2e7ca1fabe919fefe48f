{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "95ecb5db_b55fedbd",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1000869
      },
      "writtenOn": "2022-08-24T15:17:54Z",
      "side": 1,
      "message": "Hi Andrew,\n\nI have updated the design based on the entity-manager configurations for physical LEDs. Also submitted the implementation in gerrit (https://gerrit.openbmc.org/c/openbmc/phosphor-led-sysfs/+/56590).\n\nCould you please provide your suggestion on this.\n\nThanks",
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "69745a76_af5647aa",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-09-01T04:22:00Z",
      "side": 1,
      "message": "This largely looks how I\u0027d expect now. Thanks for the write-up and apologies again for taking some time to review it. A couple of comments.",
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "e5766dbe_0d5ce76f",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-09-05T23:22:14Z",
      "side": 1,
      "message": "Hi Jayashree, Vernon has made a pretty fundamental observation that the document doesn\u0027t describe how you propose solving the problem you posed. For that I\u0027d prefer this is not submitted as is and that you do some rework to address it.",
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "fa94bf5b_511dd316",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2022-09-06T22:52:25Z",
      "side": 1,
      "message": "I think the primary thing we\u0027re trying to solve is:\n\nHow do you associate multiple GPIOs, which each represent a color, into a single LED concept.\n\nOur systems have an \"amber and green\" LED that has two wires coming out of it.  Currently we cannot represent this in the kernel directly via device tree.  The way virtual-leds is currently implemented it is difficult to represent \"You may only have amber OR green on (but not both)\" because that state might be spread across multiple virtual LEDs, so you end up having to create virtual-virtual LEDs... (this is a horrible explanation).\n\nI haven\u0027t reviewed the document again lately but wanted to leave this comment so this primary need at an implementation level doesn\u0027t get lost in the higher level abstraction.",
      "parentUuid": "e5766dbe_0d5ce76f",
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "93613e04_835f8cce",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 6
      },
      "lineNbr": 0,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-09-07T00:00:31Z",
      "side": 1,
      "message": "\u003e so you end up having to create virtual-virtual LEDs... (this is a horrible explanation).\n\nðŸ¤£\n\nBut yeah, I understand that. I think Jayashree even explains that reasonably well in the problem description, but we fall short of describing the solution ðŸ™‚\n\nCertainly getting everything into a single process makes it less of a headache to think about.",
      "parentUuid": "fa94bf5b_511dd316",
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8e37fa15_af102694",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 19,
      "author": {
        "id": 1000163
      },
      "writtenOn": "2022-09-02T18:22:03Z",
      "side": 1,
      "message": "I am not sure by reading the design below how it fixes this problem. I see that it reduces the number of services, which I believe is a good thing, but grouping the LEDs or helping with a multi-host platform is not clear below.",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 19,
        "endChar": 20
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4e594aca_258c55ea",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 19,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-09-05T23:22:14Z",
      "side": 1,
      "message": "Yeah, reading over it again I think you\u0027re right. I was distracted by an outcome that I would like to see (all LED objects exposed by a single service rather than one per service).\n\nJayashree, I don\u0027t think what you\u0027ve written goes far enough in explaining how your proposed design helps solve the problem you\u0027ve described (controlling individual LEDs as a group).\n\nIs it achieved by LED groups in phosphor-led-manager? Are we trying to put together a mechanism to expose a single \u0027virtual\u0027 LED composed of two physical LEDs and phosphor-led-manager is none-the-wiser?",
      "parentUuid": "8e37fa15_af102694",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 19,
        "endChar": 20
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "45e24afb_068b95ea",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 19,
      "author": {
        "id": 1000869
      },
      "writtenOn": "2022-09-13T12:24:09Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "4e594aca_258c55ea",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 19,
        "endChar": 20
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "94c4e323_bedf2bc3",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 19,
      "author": {
        "id": 1000869
      },
      "writtenOn": "2022-09-16T10:43:21Z",
      "side": 1,
      "message": "A new schema will be implemented in phosphor-led-sysfs repo to handle the color control for a group of LEDs and activate one LED which must be Blink/ON and set the remaining LEDs in the OFF state.\n\nUpdated the information in the latest patchset.",
      "parentUuid": "45e24afb_068b95ea",
      "range": {
        "startLine": 17,
        "startChar": 0,
        "endLine": 19,
        "endChar": 20
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e0c6a525_880b3883",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 104,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-09-05T23:22:14Z",
      "side": 1,
      "message": "Can you explain why this is a requirement and not an implementation detail?",
      "range": {
        "startLine": 104,
        "startChar": 1,
        "endLine": 104,
        "endChar": 64
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b50d2370_ced1e976",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 104,
      "author": {
        "id": 1000869
      },
      "writtenOn": "2022-09-16T10:43:21Z",
      "side": 1,
      "message": "Changed the design doc and updated.",
      "parentUuid": "e0c6a525_880b3883",
      "range": {
        "startLine": 104,
        "startChar": 1,
        "endLine": 104,
        "endChar": 64
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "054d3f54_6aad74d4",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 170,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-09-01T04:22:00Z",
      "side": 1,
      "message": "This is always a bit of a edge case. Technically this should just be described in the EM board configuration for either the BMC or backplane or wherever the LEDs are and there\u0027s no need to describe it in the devicetree. However, if it is static configuration (which it sounds like it is if you\u0027re proposing to put it in the devicetree) then the devicetree is not an unreasonable spot for it. We just need to make sure that neither EM nor phosphor-led-sysfs detect when the LEDs already exist in sysfs and don\u0027t take any further action.",
      "range": {
        "startLine": 166,
        "startChar": 0,
        "endLine": 170,
        "endChar": 18
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b5007df2_70aebfa8",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 170,
      "author": {
        "id": 1000869
      },
      "writtenOn": "2022-09-02T13:37:30Z",
      "side": 1,
      "message": "The names which are defined in the device tree for GPIO LEDs will be given in the entity-manager configuration. Once the interface (xyz.openbmc_project.Configuration.Led) for LED is added in entity-manager dbus path, the dbus signal will triggered in phosphor-led-sysfs daemon and the properties mentioned in that interface will be read. Those properties result will represents the LED name and it will be compared with the /sys/class/leds/ path to check the LED is created or not. IF the LED name does not match with /sys/ path created, then dbus path will not be created.\n\nExample:\nDeviceTree:\n        leds {\n                compatible \u003d \"gpio-leds\";\n                ledName {\n                        label \u003d \"group:blue:powerled\";\n                        gpios \u003d \u003c\u0026gpio ASPEED_GPIO(M, 0) GPIO_ACTIVE_HIGH\u003e;\n                };\n        };\n        \nEntity Manager conf:\n\n        {\n            \"Class\": \"group\",\n            \"Name\": \"powerled\",\n            \"Name1\": \"blue\",\n            \"Type\": \"Led\"\n        }\n\nsys path :  /sys/class/leds/group:blue:powerled\n\nThis is the approach implemented in phosphor-led-sysfs repository. Only when the interface(xyz.openbmc_project.Configuration.Led) is added in entity-manager, the LED dbus path will be created.",
      "parentUuid": "054d3f54_6aad74d4",
      "range": {
        "startLine": 166,
        "startChar": 0,
        "endLine": 170,
        "endChar": 18
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "30623e8d_9528aa0a",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 170,
      "author": {
        "id": 1000163
      },
      "writtenOn": "2022-09-02T18:22:03Z",
      "side": 1,
      "message": "It seems to me that EM should only take action on entries listed in its config. If extra LEDs are described in the devicetree that are not in the EM config, they should just be ignored by EM.",
      "parentUuid": "054d3f54_6aad74d4",
      "range": {
        "startLine": 166,
        "startChar": 0,
        "endLine": 170,
        "endChar": 18
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7e20910c_1907acc2",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 170,
      "author": {
        "id": 1000869
      },
      "writtenOn": "2022-09-13T12:24:09Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "30623e8d_9528aa0a",
      "range": {
        "startLine": 166,
        "startChar": 0,
        "endLine": 170,
        "endChar": 18
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "c3e4507a_67118655",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 170,
      "author": {
        "id": 1000869
      },
      "writtenOn": "2022-09-16T10:43:21Z",
      "side": 1,
      "message": "The design doc is now changed to support udev event and entity-manager is not required now, since udev rule is used in existing platforms.",
      "parentUuid": "7e20910c_1907acc2",
      "range": {
        "startLine": 166,
        "startChar": 0,
        "endLine": 170,
        "endChar": 18
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2135c76d_d0b9a496",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 180,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-09-01T04:22:00Z",
      "side": 1,
      "message": "You\u0027ll need to add an LED schema to EntityManager for this. I don\u0027t think it\u0027s quite right that we use the type \"SysfsLed\". We should not bury Linux specifics in the device schema.\n\nLet\u0027s ping the EM maintainers to get their thoughts.",
      "range": {
        "startLine": 172,
        "startChar": 0,
        "endLine": 180,
        "endChar": 3
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "47e26297_b13ba0da",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 180,
      "author": {
        "id": 1000869
      },
      "writtenOn": "2022-09-02T13:37:30Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "2135c76d_d0b9a496",
      "range": {
        "startLine": 172,
        "startChar": 0,
        "endLine": 180,
        "endChar": 3
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "618846c0_17f9485a",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 180,
      "author": {
        "id": 1000163
      },
      "writtenOn": "2022-09-02T18:22:03Z",
      "side": 1,
      "message": "The LED is exposed via sysfs from the description in the devicetree, isn\u0027t it? If that is the case, I don\u0027t see a problem with using SysfsLed as the type.",
      "parentUuid": "2135c76d_d0b9a496",
      "range": {
        "startLine": 172,
        "startChar": 0,
        "endLine": 180,
        "endChar": 3
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1999d5dd_1a5547b5",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 180,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-09-05T23:22:14Z",
      "side": 1,
      "message": "The question is, is the Type field meant to describe the interface or the implementation? Should it be the responsibility of the board configuration to dictate *how* the LED is controlled (sysfs vs e.g. raw GPIO)? I feel like that\u0027s an implementation detail. I feel like describing the type in this way means the EM configuration is dictating that the LED must also be described in the devicetree (as there\u0027s no way to create sysfs LEDs in userspace as far as I\u0027m aware).",
      "parentUuid": "618846c0_17f9485a",
      "range": {
        "startLine": 172,
        "startChar": 0,
        "endLine": 180,
        "endChar": 3
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1bacdf4d_62a5bb3d",
        "filename": "designs/multihost-physical-led.md",
        "patchSetId": 6
      },
      "lineNbr": 180,
      "author": {
        "id": 1000869
      },
      "writtenOn": "2022-09-16T10:43:21Z",
      "side": 1,
      "message": "In the existing platforms, LEDs are configured via devicetree, therefore, udev support is proposed in the latest patchset. \n\nEntity manager can be used when plugable cards are present. Currently, EM support not required for this design, for that reason, it is removed.",
      "parentUuid": "1999d5dd_1a5547b5",
      "range": {
        "startLine": 172,
        "startChar": 0,
        "endLine": 180,
        "endChar": 3
      },
      "revId": "811b4d903b03e62444ab2e7ca1fabe919fefe48f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}