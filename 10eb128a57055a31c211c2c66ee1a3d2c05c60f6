{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "e668a6b2_cf15fe3d",
        "filename": "designs/sol-sysrq.md",
        "patchSetId": 2
      },
      "lineNbr": 22,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-08-22T00:16:24Z",
      "side": 1,
      "message": "Can we please format this as ```[usually generated by `ctrl+break`][2].```? Otherwise the rendered form looks like the following, with an odd trailing `2`:\n\n\u003e The \"break signal\" is usually generated by ctrl+break key combination.2\n\nhttps://gerrit.openbmc.org/plugins/gitiles/openbmc/docs/+/10eb128a57055a31c211c2c66ee1a3d2c05c60f6/designs/sol-sysrq.md",
      "range": {
        "startLine": 22,
        "startChar": 3,
        "endLine": 22,
        "endChar": 56
      },
      "revId": "10eb128a57055a31c211c2c66ee1a3d2c05c60f6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7889d85e_93447d33",
        "filename": "designs/sol-sysrq.md",
        "patchSetId": 2
      },
      "lineNbr": 22,
      "author": {
        "id": 1000044
      },
      "writtenOn": "2023-08-25T03:54:47Z",
      "side": 1,
      "message": "Done",
      "parentUuid": "e668a6b2_cf15fe3d",
      "range": {
        "startLine": 22,
        "startChar": 3,
        "endLine": 22,
        "endChar": 56
      },
      "revId": "10eb128a57055a31c211c2c66ee1a3d2c05c60f6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "03465274_6b842639",
        "filename": "designs/sol-sysrq.md",
        "patchSetId": 2
      },
      "lineNbr": 25,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-08-22T00:16:24Z",
      "side": 1,
      "message": "This is an alternative to `~B` mentioned below?",
      "revId": "10eb128a57055a31c211c2c66ee1a3d2c05c60f6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "df108722_1b887ef3",
        "filename": "designs/sol-sysrq.md",
        "patchSetId": 2
      },
      "lineNbr": 25,
      "author": {
        "id": 1000044
      },
      "writtenOn": "2023-08-25T03:54:47Z",
      "side": 1,
      "message": "It\u0027s the same as `\\n~B` below, let me rephrase here to make it more clear.",
      "parentUuid": "03465274_6b842639",
      "revId": "10eb128a57055a31c211c2c66ee1a3d2c05c60f6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "864429c3_172c76ac",
        "filename": "designs/sol-sysrq.md",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-08-22T00:16:24Z",
      "side": 1,
      "message": "Given we\u0027re talking about `ipmitool` here, isn\u0027t the break triggered by `Ctrl-Break` as mentioned above? Are we proposing adding another mechanism?\n\n`~B` is an SSH-ism as far as I can determine. Given that obmc-console can be tunnelled over SSH (as it is currently using dropbear) are we trying to make `ipmitool` consistent with SSH?",
      "revId": "10eb128a57055a31c211c2c66ee1a3d2c05c60f6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7ea8f98b_f1363f20",
        "filename": "designs/sol-sysrq.md",
        "patchSetId": 2
      },
      "lineNbr": 55,
      "author": {
        "id": 1000044
      },
      "writtenOn": "2023-08-25T03:54:47Z",
      "side": 1,
      "message": "The above mentioned `ctrl-break` in ipmitool is not accurate, it\u0027s actually `\\n~B`.\nUpdated here.",
      "parentUuid": "864429c3_172c76ac",
      "revId": "10eb128a57055a31c211c2c66ee1a3d2c05c60f6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b5335e98_f85b71f3",
        "filename": "designs/sol-sysrq.md",
        "patchSetId": 2
      },
      "lineNbr": 59,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-08-22T00:16:24Z",
      "side": 1,
      "message": "If we\u0027re following SSH we\u0027d expect the buffer to be `\\n~B` (the escape only works after a newline).\n\nBut do we actually need a button if the user can just do the in-band signalling themselves by typing `\\n~B`?",
      "revId": "10eb128a57055a31c211c2c66ee1a3d2c05c60f6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "db682d73_95c74837",
        "filename": "designs/sol-sysrq.md",
        "patchSetId": 2
      },
      "lineNbr": 59,
      "author": {
        "id": 1000044
      },
      "writtenOn": "2023-08-25T03:54:47Z",
      "side": 1,
      "message": "Good question.\nWe actually tried to input `\\n~B` to trigger the sysrq, but failed.\nIn the SOL\u003c-\u003ebmcweb communication, when user hit a key, the data is sent to bmcweb directly like byte by byte, so the check in `bmcweb` will not catch the whole `\\n~B` sequence.\n\nBy sending the key code by a WebUI button, it makes sure bmcweb could receive the whole sequence, and handle it as expect.\n\nIs there any suggestion on handling the case?",
      "parentUuid": "b5335e98_f85b71f3",
      "revId": "10eb128a57055a31c211c2c66ee1a3d2c05c60f6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "32c695c2_725e6dfe",
        "filename": "designs/sol-sysrq.md",
        "patchSetId": 2
      },
      "lineNbr": 59,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-08-25T06:47:30Z",
      "side": 1,
      "message": "Okay, it sounds like bmcweb needs better text stream processing. Essentially you need to insert a little state-machine that you send all input characters through to do the pattern matching.\n\n```mermaid\n---\ntitle: SSH escape state machine\n---\nstateDiagram-v2\n    direction LR\n    [*] --\u003e Empty\n    Empty --\u003e Emit: [^#92;n]\n    Emit --\u003e Empty\n    Empty --\u003e Newline: [#92;n]\n    Newline --\u003e Escape: [~]\n    Escape --\u003e EmitEscapeCode: [B]\n    EmitEscapeCode --\u003e Empty\n```\n\n[Here\u0027s a rendered version](https://mermaid.live/edit#pako:eNp1UD1PAzEM_SuR2dBl6UaQGPiQGICB22iKZF1MG3FJTjkfqKrKb8ckPV0XMjnP7_nZ7wBdcgQGtNY2sueejGrbR0VjhwOpkZFJBex2PpKNhVWwe4_bjEF_rWxU8pzP1LFPUT29VmR9uVFa36iHMPC-QqU8gZ6NWr9fXK2u42buev5f8ULfvewgonPNCa2ysrIQfuaB9YbZr37v5F7h3J6ZLo3FHhoIlAN6J-Ec_rgWeEeBLBgpHeZPCzYehYcTp3YfOzCcJ2pgGtwSEJgP7EdByXlO-bmmXUJvYMD4ltLMOf4CWjd96w)",
      "parentUuid": "db682d73_95c74837",
      "revId": "10eb128a57055a31c211c2c66ee1a3d2c05c60f6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2ffa0b46_0c078301",
        "filename": "designs/sol-sysrq.md",
        "patchSetId": 2
      },
      "lineNbr": 67,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2023-08-22T00:16:24Z",
      "side": 1,
      "message": "`\\n~B`.",
      "revId": "10eb128a57055a31c211c2c66ee1a3d2c05c60f6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1e6969c5_2e086fe1",
        "filename": "designs/sol-sysrq.md",
        "patchSetId": 2
      },
      "lineNbr": 67,
      "author": {
        "id": 1000044
      },
      "writtenOn": "2023-08-25T03:54:47Z",
      "side": 1,
      "message": "Right, will update.",
      "parentUuid": "2ffa0b46_0c078301",
      "revId": "10eb128a57055a31c211c2c66ee1a3d2c05c60f6",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}