{
  "comments": [
    {
      "unresolved": false,
      "key": {
        "uuid": "fb20e876_26b4dcfa",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-01-11T01:11:35Z",
      "side": 1,
      "message": "Hi George, thanks for the update. I\u0027ve still got some questions and comments inline.",
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "d3e598ba_c2f9324c",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 8
      },
      "lineNbr": 0,
      "author": {
        "id": 1000397
      },
      "writtenOn": "2022-01-12T02:23:15Z",
      "side": 1,
      "message": "Thanks Andrew.\nTBH, I am new to writing design documents ðŸ˜Š",
      "parentUuid": "fb20e876_26b4dcfa",
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "639858df_b1242163",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 45,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-01-11T01:11:35Z",
      "side": 1,
      "message": "Given we\u0027re using udev why does it have to specifically be /run/media/usb/sda1? Why not write the rule so it\u0027s generic for any device name?",
      "range": {
        "startLine": 45,
        "startChar": 30,
        "endLine": 45,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e7b36bde_1056aed9",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 45,
      "author": {
        "id": 1000397
      },
      "writtenOn": "2022-01-12T02:23:15Z",
      "side": 1,
      "message": "\u003e Given we\u0027re using udev why does it have to specifically be /run/media/usb/sda1? Why not write the rule so it\u0027s generic for any device name?\n\n`/run/media/usb` is hard-code, refer: https://github.com/openbmc/phosphor-bmc-code-mgmt/blob/master/usb/usb_manager_main.cpp#L31",
      "parentUuid": "639858df_b1242163",
      "range": {
        "startLine": 45,
        "startChar": 30,
        "endLine": 45,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2ccf3de2_4b657583",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 45,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-01-12T03:23:19Z",
      "side": 1,
      "message": "Oh, sorry, I wasn\u0027t clear in what I was asking. What you wrote makes it sound like it\u0027s specific to sda1 (the path to the mountpoint, /run/media/usb here, isn\u0027t really relevant). The code shouldn\u0027t be specific to sda1.",
      "parentUuid": "e7b36bde_1056aed9",
      "range": {
        "startLine": 45,
        "startChar": 30,
        "endLine": 45,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "aece5a10_234415b9",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 45,
      "author": {
        "id": 1000397
      },
      "writtenOn": "2022-01-12T03:31:55Z",
      "side": 1,
      "message": "\u003e Oh, sorry, I wasn\u0027t clear in what I was asking. What you wrote makes it sound like it\u0027s specific to sda1 (the path to the mountpoint, /run/media/usb here, isn\u0027t really relevant). The code shouldn\u0027t be specific to sda1.\n\nOH, Sorry, it is not specific to sda1.\nRefer: https://github.com/openbmc/phosphor-bmc-code-mgmt/blob/master/usb/70-bmc-usb.rules",
      "parentUuid": "2ccf3de2_4b657583",
      "range": {
        "startLine": 45,
        "startChar": 30,
        "endLine": 45,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bd9ce5f0_23dda61c",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 51,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-01-11T01:11:35Z",
      "side": 1,
      "message": "This is the first time this new daemon is mentioned. What\u0027s its purpose? I think it needs more words to describe its role.",
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "b915c8f0_89f996f2",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 51,
      "author": {
        "id": 1000397
      },
      "writtenOn": "2022-01-12T02:23:15Z",
      "side": 1,
      "message": "Ack",
      "parentUuid": "bd9ce5f0_23dda61c",
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e583f383_deaff8a0",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 57,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-01-11T01:11:35Z",
      "side": 1,
      "message": "We can use `DRIVERS\u003d\u003d\"usb-storage\"` here instead and make it generic?",
      "range": {
        "startLine": 57,
        "startChar": 35,
        "endLine": 57,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3652660d_7babb5c1",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 57,
      "author": {
        "id": 1000397
      },
      "writtenOn": "2022-01-12T02:23:15Z",
      "side": 1,
      "message": "\u003e We can use `DRIVERS\u003d\u003d\"usb-storage\"` here instead and make it generic?\n\nSorry, USB driver is done by IBM.\n@Adriana, What do you think?",
      "parentUuid": "e583f383_deaff8a0",
      "range": {
        "startLine": 57,
        "startChar": 35,
        "endLine": 57,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "903eafa8_732fc2cf",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 57,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-01-12T03:23:19Z",
      "side": 1,
      "message": "I don\u0027t understand. There\u0027s nothing that shouldn\u0027t work if you replace `KERNEL\u003d\u003d\"sda1\"` with `DRIVERS\u003d\u003d\"usb-storage\"`. It should just do the right thing automatically without any limitation like is imposed if we use `KERNEL\u003d\u003d\"sda1\"`.",
      "parentUuid": "3652660d_7babb5c1",
      "range": {
        "startLine": 57,
        "startChar": 35,
        "endLine": 57,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "49ba6aa7_8b9dce27",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 57,
      "author": {
        "id": 1000397
      },
      "writtenOn": "2022-01-12T03:31:55Z",
      "side": 1,
      "message": "\u003e I don\u0027t understand. There\u0027s nothing that shouldn\u0027t work if you replace `KERNEL\u003d\u003d\"sda1\"` with `DRIVERS\u003d\u003d\"usb-storage\"`. It should just do the right thing automatically without any limitation like is imposed if we use `KERNEL\u003d\u003d\"sda1\"`.\n\nOkay, Maybe I am not familiar with this, Let me test it, Thanks",
      "parentUuid": "903eafa8_732fc2cf",
      "range": {
        "startLine": 57,
        "startChar": 35,
        "endLine": 57,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fb0717df_36518156",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 57,
      "author": {
        "id": 1000000
      },
      "writtenOn": "2022-02-01T20:24:15Z",
      "side": 1,
      "message": "Agreed.  The choice of \u0027sda1\u0027 is rather restrictive.  You\u0027re not certain that the USB will be mounted as that device or if sda1 will contain a vfat file system.  (I don\u0027t see any mention of file system here... are you restricting to a particular file system)  On systems with eMMC, I wouldn\u0027t be surprised if sda is actually the eMMC device.",
      "parentUuid": "49ba6aa7_8b9dce27",
      "range": {
        "startLine": 57,
        "startChar": 35,
        "endLine": 57,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "df53df4f_8cc4bbfb",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 57,
      "author": {
        "id": 1000003
      },
      "writtenOn": "2022-02-09T20:39:10Z",
      "side": 1,
      "message": "I confirmed this line in the udev rules file works, needed also the devtype to differentiate the disk sdX from the partition sdX1:\n\nSUBSYSTEM\u003d\u003d\"block\", ACTION\u003d\u003d\"add\", ENV{ID_USB_DRIVER}\u003d\u003d\"usb-storage\", ENV{DEVTYPE}\u003d\u003d\"partition\", ENV{SYSTEMD_WANTS}\u003d\"usb-code-update@%k\", TAG+\u003d\"systemd\"\n\nIt removes the dependency on just supporting re-plugging the usb twice, so now even if the usb is plugged a 3rd time and the kernel creates the sdc1 partition the code update is still triggered:\n\nFeb 09 20:34:25 localhost kernel:  sdc: sdc1\nFeb 09 20:34:25 localhost kernel: sd 2:0:0:0: [sdc] Attached SCSI removable disk\nFeb 09 20:34:25 localhost systemd[1]: Started FW Code Update via USB sdc1.\n\nroot@localhost:~# udevadm test -a add $(udevadm info -q path -n /dev/sdc1)\n..\nSYSTEMD_WANTS\u003dusb-code-update@sdc1",
      "parentUuid": "fb0717df_36518156",
      "range": {
        "startLine": 57,
        "startChar": 35,
        "endLine": 57,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "35d16dca_a9f505b1",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 57,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2022-02-18T00:31:47Z",
      "side": 1,
      "message": "This isn\u0027t fixed?",
      "parentUuid": "df53df4f_8cc4bbfb",
      "range": {
        "startLine": 57,
        "startChar": 35,
        "endLine": 57,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "085b08bc_c2ba99e6",
        "filename": "designs/firmware-update-via-usb.md",
        "patchSetId": 8
      },
      "lineNbr": 57,
      "author": {
        "id": 1000397
      },
      "writtenOn": "2022-02-18T01:19:02Z",
      "side": 1,
      "message": "\u003e This isn\u0027t fixed?\n\nsorry.\nfixed",
      "parentUuid": "35d16dca_a9f505b1",
      "range": {
        "startLine": 57,
        "startChar": 35,
        "endLine": 57,
        "endChar": 49
      },
      "revId": "18a7c2ab68ee886c21fd01a7526e6016c134dd69",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}