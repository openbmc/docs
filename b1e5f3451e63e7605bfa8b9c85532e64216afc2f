{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "190fd421_9d7b5886",
        "filename": "/COMMIT_MSG",
        "patchSetId": 18
      },
      "lineNbr": 14,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-01-15T20:13:16Z",
      "side": 1,
      "message": "Please wrap 50/72 as the developing guide asks.",
      "range": {
        "startLine": 8,
        "startChar": 0,
        "endLine": 14,
        "endChar": 0
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "03907f36_66b8efee",
        "filename": "/COMMIT_MSG",
        "patchSetId": 18
      },
      "lineNbr": 14,
      "author": {
        "id": 1001354
      },
      "writtenOn": "2024-01-16T21:08:44Z",
      "side": 1,
      "message": "To confirm-- the issue is that the lines of my body were wrapping *too early*, not that they had too many characters, correct?\n\nThanks for the heads up, I think I had only been watching to make sure I didn\u0027t go over the 50/72 boundaries when I made my last change.",
      "parentUuid": "190fd421_9d7b5886",
      "range": {
        "startLine": 8,
        "startChar": 0,
        "endLine": 14,
        "endChar": 0
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "7a36bf9c_3714c268",
        "filename": "/COMMIT_MSG",
        "patchSetId": 18
      },
      "lineNbr": 14,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-01-16T22:00:40Z",
      "side": 1,
      "message": "Usually your editor can be configured to automatically wrap the text at the required column. Failing that there\u0027s always [fold](https://www.man7.org/linux/man-pages/man1/fold.1.html).",
      "parentUuid": "03907f36_66b8efee",
      "range": {
        "startLine": 8,
        "startChar": 0,
        "endLine": 14,
        "endChar": 0
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "1e78607d_29da87ef",
        "filename": "/COMMIT_MSG",
        "patchSetId": 18
      },
      "lineNbr": 14,
      "author": {
        "id": 1001354
      },
      "writtenOn": "2024-01-17T16:09:40Z",
      "side": 1,
      "message": "That\u0027s a very useful command I didn\u0027t know about, thanks! Can you tell me what editor you prefer that has word wrapping where you can define the column to wrap on?\n\nI\u0027ve been using Notepad++. It does have word-wrap functionality, but not column-definable out of the box.",
      "parentUuid": "7a36bf9c_3714c268",
      "range": {
        "startLine": 8,
        "startChar": 0,
        "endLine": 14,
        "endChar": 0
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bbd9ee35_bb845a25",
        "filename": "/COMMIT_MSG",
        "patchSetId": 18
      },
      "lineNbr": 14,
      "author": {
        "id": 1001354
      },
      "writtenOn": "2024-01-17T16:23:42Z",
      "side": 1,
      "message": "(Removing \u0027resolved\u0027 flag to keep replies open...)",
      "parentUuid": "1e78607d_29da87ef",
      "range": {
        "startLine": 8,
        "startChar": 0,
        "endLine": 14,
        "endChar": 0
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "83b669ea_ed334998",
        "filename": "/COMMIT_MSG",
        "patchSetId": 18
      },
      "lineNbr": 14,
      "author": {
        "id": 1000008
      },
      "writtenOn": "2024-01-17T16:55:54Z",
      "side": 1,
      "message": "I\u0027m not sure if git defaults to vim for commit messages or if it just does for me because I use (neo)vim for everything, but that is easy to configure to handle the 50/72 lengths, including reformatting paragraphs or the whole thing with \u0027gw\u0027.",
      "parentUuid": "bbd9ee35_bb845a25",
      "range": {
        "startLine": 8,
        "startChar": 0,
        "endLine": 14,
        "endChar": 0
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "47ed1056_68526eed",
        "filename": "/COMMIT_MSG",
        "patchSetId": 18
      },
      "lineNbr": 14,
      "author": {
        "id": 1001354
      },
      "writtenOn": "2024-01-17T18:11:37Z",
      "side": 1,
      "message": "I\u0027ve got some novice level experience with vim, but hadn\u0027t tried setting a word-wrap with there, and I haven\u0027t tried neovim yet. Good info, thanks!",
      "parentUuid": "83b669ea_ed334998",
      "range": {
        "startLine": 8,
        "startChar": 0,
        "endLine": 14,
        "endChar": 0
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1a93aded_d83dc568",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 18
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "IMO, this design is communicating data with uboot, therefore it goes in a daemon that communicates with uboot, https://github.com/openbmc/phosphor-u-boot-env-mgr which also has the advantage that the existing code will now be better maintained.  Even if none of the code is in common, sharing the repo with all uboot communication code is organizationally much better in my opinion, because it adds to the idea that solutions are generic, not platform specific.  Keep in mind, phosphor-u-boot-env-mgr has less executable code than this design document has words, so getting it maintained and used shouldn\u0027t be a huge burden to put on the authors of this document.\n\nI don\u0027t really buy into the idea that HPe platforms are so unique that they require yet another daemon to communicate data from uboot into dbus.  Maybe it operates in some unique ways using some unique ram regions but it\u0027s still transferring data uboot-\u003edbus, and should share the code that already exists, even if it\u0027s only in name. \"If the HPe u-boot node exists\" seems like something that the code could trivially branch on and be added to by others later.\n\nIn addition, this document needs unified with https://gerrit.openbmc.org/c/openbmc/docs/+/65678\n\nWhich still has a number of open comments from core maintainers, and has an author comment that says:\n\n\u003e I\u0027m now planning to update this proposal to discuss creating a \u0027u-boot-env FRU-alternative\u0027 daemon (non-HPE-specific) in Entity-Manager that would make use of the phosphor-u-boot-env-mgr service (if exists) to move HW identifying data to D-Bus.\"\n\nHopefully it\u0027s easy to see why I\u0027m confused why there\u0027s yet another design doc for what amounts to the same feature.\n\nGiven how long this design has been in-progress, I\u0027m assuming this implementation already exists in a fork somewhere?  To be clear, working code isn\u0027t a prerequisite for a design approval, but if it exists, providing a pointer to it would likely answer quite a few questions better than text descriptions, and give us something to point to when making specific suggestions about dbus interfaces.",
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fce7cff0_6d577e6d",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 18
      },
      "lineNbr": 0,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-02-07T00:29:16Z",
      "side": 1,
      "message": "\u003e IMO, this design is communicating data with uboot, therefore it goes in a daemon that communicates with uboot, https://github.com/openbmc/phosphor-u-boot-env-mgr\n\nLet\u0027s hold up there. I think there\u0027s a bit more nuance to it than that. The environment is not the only method via which u-boot exchanges data with other parts of the system. The devicetree is another, and its purpose is to describe the hardware. Modifying devicetrees at runtime is expected practice - firmware often generates them at runtime.\n\nThe purpose of the u-boot environment is to allow configuration of the behaviour of u-boot. Ideally it shouldn\u0027t have a purpose beyond that.\n\nThe complete list of properties that HPE are concerned with are enumerated in the document:\n\n1. `server_id` (platform model id)\n2. `pca_part_number` (baseboard part no)\n3. `pca_serial_number` (baseboard serial no)\n4. `part_number` (platform product no, set at assembly by factory)\n5. `serial_number` (system serial no, assigned at assembly by factory)\n6. `mac0` (if present: MAC address for dedicated BMC network interface)\n7. `mac1` (if present: MAC address for secondary network interface that may or may not be shared with host)\n\nThe network device schema provides the [`local-mac-address` property](https://github.com/devicetree-org/devicetree-specification/blob/main/source/chapter4-device-bindings.rst#local-mac-address-property), addressing `mac0` (6) and `mac1` (7).\n\nThe [`model` property](https://github.com/devicetree-org/devicetree-specification/blob/main/source/chapter3-devicenodes.rst?plain\u003d1#L39) should encode `pca_part_number` (2) if this is where the GXP SoC is situated. Under that assumption the [`serial-number` property](https://github.com/devicetree-org/devicetree-specification/blob/main/source/chapter3-devicenodes.rst?plain\u003d1#L53) addresses `pca_serial_number` (3). The baseboard model should be what\u0027s driving the EM configs, it represents the hardware that\u0027s present.\n\nAs an alternative regarding 1, IBM, for example, embed the platform model string in the `model` property:\n\nhttps://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/arm/boot/dts/aspeed/aspeed-bmc-ibm-rainier.dts?h\u003dv6.7#n11\n\nThis method might be used to expose `server_id` (1) or possibly `part_number` (4), but really I think we need to have the EM config probe on the baseboard if that\u0027s where the GXP SoC is situated.\n\nInformation should be placed where it\u0027s designed to go. As far as I\u0027m concerned, that\u0027s the devicetree for the properties discussed above, with the caveat that it may be necessary to put the MAC addresses into the u-boot environment for the purpose of enabling networking in u-boot.\n\nIf we have to use the environment to convey some of the information that doesn\u0027t fit anywhere else, then so be it. But I think the design point is feasible using specified properties in the devicetree for their designated purpose.\n\n\u003e I don\u0027t really buy into the idea that HPe platforms are so unique that they require yet another daemon to communicate data from uboot into dbus\n\nI don\u0027t think the design-point of hosting specific data from the devicetree is unexpected. HPE might be the first people to hit on it, but it\u0027s certainly more broadly applicable. It\u0027s not code that is specific to a HPE platform design. It has broader utility.\n\n\u003e In addition, this document needs unified with https://gerrit.openbmc.org/c/openbmc/docs/+/65678\n\n+1, I\u0027ve been confused by this several times.",
      "parentUuid": "1a93aded_d83dc568",
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c021be83_8107b1a0",
        "filename": "/PATCHSET_LEVEL",
        "patchSetId": 18
      },
      "lineNbr": 0,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-07T01:20:42Z",
      "side": 1,
      "message": "\u003e \u003e IMO, this design is communicating data with uboot, therefore it goes in a daemon that communicates with uboot, https://github.com/openbmc/phosphor-u-boot-env-mgr\n\u003e \n\u003e Let\u0027s hold up there. I think there\u0027s a bit more nuance to it than that. The environment is not the only method via which u-boot exchanges data with other parts of the system. The devicetree is another, and its purpose is to describe the hardware. Modifying devicetrees at runtime is expected practice - firmware often generates them at runtime.\n\nAt no point did I say that the environment is the _only_ way u-boot communicates with userspace.\n\n\u003e \n\u003e The purpose of the u-boot environment is to allow configuration of the behaviour of u-boot. Ideally it shouldn\u0027t have a purpose beyond that.\n\nCool.\n\n\u003e \n\u003e The complete list of properties that HPE are concerned with are enumerated in the document:\n\u003e \n\u003e 1. `server_id` (platform model id)\n\u003e 2. `pca_part_number` (baseboard part no)\n\u003e 3. `pca_serial_number` (baseboard serial no)\n\u003e 4. `part_number` (platform product no, set at assembly by factory)\n\u003e 5. `serial_number` (system serial no, assigned at assembly by factory)\n\u003e 6. `mac0` (if present: MAC address for dedicated BMC network interface)\n\u003e 7. `mac1` (if present: MAC address for secondary network interface that may or may not be shared with host)\n\u003e \n\u003e The network device schema provides the [`local-mac-address` property](https://github.com/devicetree-org/devicetree-specification/blob/main/source/chapter4-device-bindings.rst#local-mac-address-property), addressing `mac0` (6) and `mac1` (7).\n\u003e \n\u003e The [`model` property](https://github.com/devicetree-org/devicetree-specification/blob/main/source/chapter3-devicenodes.rst?plain\u003d1#L39) should encode `pca_part_number` (2) if this is where the GXP SoC is situated. Under that assumption the [`serial-number` property](https://github.com/devicetree-org/devicetree-specification/blob/main/source/chapter3-devicenodes.rst?plain\u003d1#L53) addresses `pca_serial_number` (3). The baseboard model should be what\u0027s driving the EM configs, it represents the hardware that\u0027s present.\n\u003e \n\u003e As an alternative regarding 1, IBM, for example, embed the platform model string in the `model` property:\n\u003e \n\u003e https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/tree/arch/arm/boot/dts/aspeed/aspeed-bmc-ibm-rainier.dts?h\u003dv6.7#n11\n\u003e \n\u003e This method might be used to expose `server_id` (1) or possibly `part_number` (4), but really I think we need to have the EM config probe on the baseboard if that\u0027s where the GXP SoC is situated.\n\u003e \n\u003e Information should be placed where it\u0027s designed to go. As far as I\u0027m concerned, that\u0027s the devicetree for the properties discussed above, with the caveat that it may be necessary to put the MAC addresses into the u-boot environment for the purpose of enabling networking in u-boot.\n\n\u003e \n\u003e If we have to use the environment to convey some of the information that doesn\u0027t fit anywhere else, then so be it. But I think the design point is feasible using specified properties in the devicetree for their designated purpose.\n\u003e \n\u003e \u003e I don\u0027t really buy into the idea that HPe platforms are so unique that they require yet another daemon to communicate data from uboot into dbus\n\u003e \n\u003e I don\u0027t think the design-point of hosting specific data from the devicetree is unexpected. HPE might be the first people to hit on it, but it\u0027s certainly more broadly applicable. It\u0027s not code that is specific to a HPE platform design. It has broader utility.\n\n\nI wasn\u0027t very clear I guess.  I have no problem with the information being placed in devicetree, that seems like a reasonable thing to do, for all the reasons you mentioned, I would just like to see that preboot (uboot for now) to userspace communications are done in the same daemon, and the interfaces are such that someone with access to a mainboard could reasonably construct a proper probe statement.\n\n\u003e \n\u003e \u003e In addition, this document needs unified with https://gerrit.openbmc.org/c/openbmc/docs/+/65678\n\u003e \n\u003e +1, I\u0027ve been confused by this several times.\n\n+2ing this, so it doesn\u0027t get lost in the thread.",
      "parentUuid": "fce7cff0_6d577e6d",
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c91da47d_513a6d9a",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 13,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "This sounds very similar to the Tyan file format (which FRU device handles) or the VPD IBM parser design.  Could you please add those into your background?  Ideally also with details on why this design is taking a different approach.",
      "range": {
        "startLine": 13,
        "startChar": 0,
        "endLine": 13,
        "endChar": 65
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2a54c7df_66df8232",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 57,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "I\u0027m not quite understanding this section.  If there are portions that are required to make this work that cannot be open sourced, what\u0027s the point of this design?  If nobody can build a GXP OpenBMC image that works, why open source just a portion?  Just keep the proprietary implementation, support it, and call it done.  Calling something \"OpenBMC\" without open sourcing the code to actually make it work it doesn\u0027t seem appropriate, or useful to a user.",
      "range": {
        "startLine": 54,
        "startChar": 0,
        "endLine": 57,
        "endChar": 47
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8b51f0fc_44b51256",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 57,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-02-07T00:29:16Z",
      "side": 1,
      "message": "I\u0027m an open source enthusiast as much as any other, but I think we need to be a bit pragmatic here. Is it ideal? No. Is the bootblock required by their secure-boot architecture? Yes. Are there other similarities in the ecosystem? Well, the Aspeed boot ROM isn\u0027t open source either (this would be useful just for inspection purposes).\n\nLet\u0027s acknowledge that HPE are making pretty good progress with making the *rest* of their BMC stack open source. I prefer progress over perfection.",
      "parentUuid": "2a54c7df_66df8232",
      "range": {
        "startLine": 54,
        "startChar": 0,
        "endLine": 57,
        "endChar": 47
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "6b5a2d4f_292beedd",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 57,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-07T01:20:42Z",
      "side": 1,
      "message": "\u003e I\u0027m an open source enthusiast as much as any other, but I think we need to be a bit pragmatic here. Is it ideal? No. Is the bootblock required by their secure-boot architecture? Yes. Are there other similarities in the ecosystem? Well, the Aspeed boot ROM isn\u0027t open source either (this would be useful just for inspection purposes).\n\nRight, but I can do a build with the ROM as part of it.  Maybe I misunderstood, so let me ask the pointed question:\n\nWhen this design doc is done, can I build a bmc that boots on an HPE platform and see this feature function as intended?  From the sounds of this text block the answer is no, but given the above that we\u0027re comparing to the aspeed boot rom, which I CAN build and run (even if it\u0027s a binary blob), that\u0027s a different consideration entirely.\n\n\u003e \n\u003e Let\u0027s acknowledge that HPE are making pretty good progress with making the *rest* of their BMC stack open source. I prefer progress over perfection.\n\nAbsolutely.  I mentioned on discord that this point is probably out of scope for this design discussion.  Resolving in this context.",
      "parentUuid": "8b51f0fc_44b51256",
      "range": {
        "startLine": 54,
        "startChar": 0,
        "endLine": 57,
        "endChar": 47
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e64842f0_8bbbb827",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 61,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "Getting this into an upstream uboot or openbmc uboot would presumably be a prerequisite of acceptance of this design?  has that discussion been started?  Can you link it?",
      "range": {
        "startLine": 58,
        "startChar": 0,
        "endLine": 61,
        "endChar": 58
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7684dbb9_0bd5b018",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 124,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "Why is openbmc pointing at this u-boot fork?\n\nhttps://github.com/openbmc/openbmc/blob/8a4267b756cd3dadf58a01d1c96764f8d80077ee/meta-hpe/meta-gxp/recipes-bsp/u-boot/u-boot-common-gxp_2020.10.inc#L12C1-L13C1\n\npresumably HPe would need to follow the process that Nuvoton and Aspeed did, and get it included in https://github.com/openbmc/u-boot  Have you discussed that with Joel?\n\nAs written this seems like it\u0027s in direct contradiction of\nhttps://github.com/openbmc/docs/blob/master/meta-layer-guidelines.md\n\nTrying to propose \"generic\" solutions that apply to everything when the underlying implementation seems like we\u0027re making a huge amount of technical debt.\n\nThe fact that HPe is both a system manufacturer, and makes its own BMC was maybe why this was allowed?",
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "89209727_502dc791",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 128,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "In the past we haven\u0027t put manufacturer specific daemons in entity-manager.  the IBM VPD is parsed by its own repo.  Any reason we\u0027d put it in EM this time around?  If we\u0027re changing that, should we move the IBM daemon into EM?\n\nThe doc you reference still has quite a few open comments, and is really difficult to reconcile with this design.",
      "range": {
        "startLine": 128,
        "startChar": 0,
        "endLine": 128,
        "endChar": 81
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "d3b14b9b_ccf34323",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 128,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-02-07T00:29:16Z",
      "side": 1,
      "message": "This wouldn\u0027t be a manufacturer-specific daemon. It would be a small amount of code exposing the root `model` and `serial-number` devicetree properties on D-Bus that is applicable on almost any system.",
      "parentUuid": "89209727_502dc791",
      "range": {
        "startLine": 128,
        "startChar": 0,
        "endLine": 128,
        "endChar": 81
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "b7fcf0b3_e571f130",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 134,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "This seems like an issue in naming.\n\nEntity manager files are intended to represent what physically exists on a component such that it\u0027s not debatable what the interfaces are, and those without OpenBMC experience can write config files.\n\nxyz.openbmc_project.Inventory.Decorator.Compatible doesn\u0027t represent anything about the physical board, and means nothing in the real world without knowing exactly how the software is configured.  I suspect we would need naming that conveys something to the effect of: \"HPe format FRU manufacturer field equals X\"\n\nThus we\u0027re not relying on a particular distro/software config to write those Compatible flags, which would require the EM config writer to understand a lot more about how OpenBMC is structured, and whos probe elements might be subjective.\n\nYou\u0027ll notice the existing FRU device entries follow this \"IPMI FRU Manufacturer field equals X\" pattern.  An example of an IBM OEM parser is below.\n\nhttps://github.com/openbmc/entity-manager/blob/8d2ed842534cc63b446321faa17b5d400350f6a3/configurations/rainier_1s4u_chassis.json#L24C23-L24C23\n\nthat example then publishes xyz.openbmc_project.Inventory.Decorator.Compatible as a result.  Your design is inverting that.  At a minimum we need to use something other than Compatible as the EM probe, so we don\u0027t have a disconnect between which object owns the Compatible interface.",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 134,
        "endChar": 38
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "fb229664_474521e5",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 134,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-02-07T00:29:16Z",
      "side": 1,
      "message": "\u003e xyz.openbmc_project.Inventory.Decorator.Compatible doesn\u0027t represent anything about the physical board, and means nothing in the real world without knowing exactly how the software is configured. I suspect we would need naming that conveys something to the effect of: \"HPe format FRU manufacturer field equals X\"\n\nWhat about https://github.com/openbmc/phosphor-dbus-interfaces/blob/master/yaml/xyz/openbmc_project/Inventory/Decorator/Asset.interface.yaml ?\n\nIt lives in the `Decorator` namespace, but it does all the things we need it to do.",
      "parentUuid": "b7fcf0b3_e571f130",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 134,
        "endChar": 38
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "1a052fd6_f30e2efb",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 134,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-07T01:20:42Z",
      "side": 1,
      "message": "Decorator.Asset again, doesn\u0027t mean anything in the real world, so when we do board ports, people will need to go look up what exists.\n\nHow about something like:\nSpiFlashFru(Model \u003d )\n\nThe physical board has a fru field in flash, which is what we\u0027re technically probing on, and exists in the real world.  \"devicetree\" doesn\u0027t exist to a hardware engineer, so I\u0027m intentionally avoiding using it as an interface name.",
      "parentUuid": "fb229664_474521e5",
      "range": {
        "startLine": 132,
        "startChar": 0,
        "endLine": 134,
        "endChar": 38
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5dba13ab_7fc05810",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 138,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "Please wrap your document on 80 character boundaries.  There are lots of issues, this is only one.  Please fix all of them.\n\nI\u0027m assuming it wasn\u0027t intentional for these to be headings.  They appear to be text.",
      "range": {
        "startLine": 137,
        "startChar": 0,
        "endLine": 138,
        "endChar": 94
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": false,
      "key": {
        "uuid": "86bc574f_247f6187",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 146,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "Agreed.",
      "range": {
        "startLine": 146,
        "startChar": 0,
        "endLine": 146,
        "endChar": 51
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3c9376fa_5ffaaff7",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 196,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "Would increase code reuse and testing.",
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "369fce52_4a57a163",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 199,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "What does this mean?  The \"preferred\" design has the same chain length, right?  It just puts a new daemon in the entity-manager repo instead of reusing an existing one?",
      "range": {
        "startLine": 199,
        "startChar": 0,
        "endLine": 199,
        "endChar": 74
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "809fc311_7eb9a6f3",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 201,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "Why is this a con?  Saving cycles doesn\u0027t seem like a bad thing, even if it isn\u0027t important?",
      "range": {
        "startLine": 200,
        "startChar": 0,
        "endLine": 201,
        "endChar": 12
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3693a99b_64c91477",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 209,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "Better abstraction is another pro.",
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "5beb64d7_066667df",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 214,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "?  what does this mean?  I\u0027m really not sure why the location of the code would change how things are able to be leveraged?",
      "range": {
        "startLine": 213,
        "startChar": 0,
        "endLine": 214,
        "endChar": 58
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "532b95b0_f499d1d4",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 214,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:23:54Z",
      "side": 1,
      "message": "In addition, remove the mention of GPIO-\u003edbus daemon.  Such a daemon has been discussed so many times that there\u0027s a doc on why it\u0027s not going to be permitted.",
      "parentUuid": "5beb64d7_066667df",
      "range": {
        "startLine": 213,
        "startChar": 0,
        "endLine": 214,
        "endChar": 58
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "591a03a8_8d647c5b",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 214,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-02-07T00:29:16Z",
      "side": 1,
      "message": "See https://github.com/openbmc/docs/blob/master/anti-patterns.md#dbus-interface-representing-gpios",
      "parentUuid": "532b95b0_f499d1d4",
      "range": {
        "startLine": 213,
        "startChar": 0,
        "endLine": 214,
        "endChar": 58
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "a6d2601e_b8f6c668",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 216,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "I\u0027m not really following how this is different aside from where you\u0027re putting the new daemon.  FWIW, putting all uboot communication code in the same place seems like it would save significant dependencies?\n\nIf I\u0027m understanding the design correctly, this alternative would be my preference.",
      "range": {
        "startLine": 216,
        "startChar": 0,
        "endLine": 216,
        "endChar": 132
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4fafb049_9455cb86",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 217,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "https://gerrit.openbmc.org/c/openbmc/docs/+/65678 still lists \n\n\u003e This proposal aims to leverage\n[phosphor-u-boot-enviornmental-manager](https://github.com/openbmc/phosphor-u-boot-env-mgr)\u0027s\nu-Boot -\u003e D-Bus data transfer functionality in order to bridge the gap from\nu-Boot to make passed-through HW data available on D-Bus, where it can be acted\nupon by Entity-Manager processes.\n\n\nPresumably that needs updated and synced up with this one?\n\n\nFWIW, I\u0027m having a lot of trouble syncing those two documents in my head.  They\u0027re effectively solving the same problem, were written by the same author, and have tons of overlap between them, while not being consistent in what they say the implementation is.\n\nCan we combine them please into a single \"Here\u0027s how to detect HPe hardware\" document so that we have one consistent source for how this is designed?",
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "0c49ad47_eaf07704",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 222,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "Why not just enable phosphor uboot env manager by default?  Seems similar to what we\u0027re already proposing, just we\u0027re instead putting code in EM.",
      "range": {
        "startLine": 221,
        "startChar": 36,
        "endLine": 222,
        "endChar": 11
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4fe7e11e_c6a81303",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 228,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "not sure I agree with this, and as worded, \"feeling messy\" isn\u0027t very easy to connect with given its so abstract.\n\n\nAt the end of the day, SOME daemon needs to translate the raw data structures into high level DBus interfaces.  This can be:\n\nEntity-manager.  Given the fact that entity-manager doesn\u0027t currently talk directly to hardware, this seems ill advised, and would cause worse failure modes (failure to get uboot data would cause failure of all EM configs).\n\nphosphor-u-boot-env-mgr.  This would be my preference, given it already has a design for exposing uboot information to DBus.  Even if the code doesn\u0027t currently do it exactly the way we want, having all the uboot-\u003edbus communication code in one place seems like a good idea.  I would advise enabling this daemon by default, similar to what the \"put this in entity-manager\" approach is wanting\n\nNew daemon in entity-manager repo.  I\u0027m not sure entity-manager is the right fit here, as I\u0027m not really sure what code this implementation and entity-manager would share.  Large amounts of shared code instead of copied code would be the only reason I would support this, but I don\u0027t really see it.  Most of the code in EM is specific to EM.",
      "range": {
        "startLine": 227,
        "startChar": 3,
        "endLine": 228,
        "endChar": 60
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8de8f18f_3485293f",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 228,
      "author": {
        "id": 1000009
      },
      "writtenOn": "2024-02-07T00:29:16Z",
      "side": 1,
      "message": "It was on the basis that it is an alternative to fru-device, which also lives in the EM repo, and it doesn\u0027t have anywhere near the complexity of something like the IBM VPD stuff.",
      "parentUuid": "4fe7e11e_c6a81303",
      "range": {
        "startLine": 227,
        "startChar": 3,
        "endLine": 228,
        "endChar": 60
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9a55b2a2_c484cc05",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 228,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-07T01:20:42Z",
      "side": 1,
      "message": "\u003e It was on the basis that it is an alternative to fru-device, which also lives in the EM repo, and it doesn\u0027t have anywhere near the complexity of something like the IBM VPD stuff.\n\nmy key point is that I would like to see like communication paths put in the same daemon.  communicating u-boot -\u003e userspace seems like a class of communication that organizationally should live together.\n\nAs far as where it specifically lives, if we really want EM, I\u0027m fine with that, but lets start by moving phosphor-uboot-env manager in, and go from there.",
      "parentUuid": "8de8f18f_3485293f",
      "range": {
        "startLine": 227,
        "startChar": 3,
        "endLine": 228,
        "endChar": 60
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "3d93193b_4984cf6e",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 245,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "Still need to answer who will maintain this code.  Presumably the existing entity-manager maintainers don\u0027t have a GXP system, so is someone from HPe getting added to reviews for correctness?  Please get that person added as a reviewer and start doing code reviews of EM patchsets.",
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "9bc856c6_d2a5a7f4",
        "filename": "designs/entity-manager-hw-detect-via-device-tree.md",
        "patchSetId": 18
      },
      "lineNbr": 252,
      "author": {
        "id": 1000153
      },
      "writtenOn": "2024-02-06T20:13:19Z",
      "side": 1,
      "message": "That\u0027s not really what this section is for.  Are you going to write:\n\nUnit tests?\nFunctional tests?\nManual tests?\n\nYou\u0027ve called out which platform you plan on testing on, which is good, lets just get the next level of detail on how you intend to test this.",
      "range": {
        "startLine": 249,
        "startChar": 0,
        "endLine": 252,
        "endChar": 56
      },
      "revId": "b1e5f3451e63e7605bfa8b9c85532e64216afc2f",
      "serverId": "adbd0a64-1f21-4d83-b585-671fe73cb6e4"
    }
  ]
}